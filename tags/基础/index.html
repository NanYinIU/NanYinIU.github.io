<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>æ ‡ç­¾: åŸºç¡€ - NanYinçš„åšå®¢</title><meta description="Was mich nicht umbringt, macht mich starker."><meta property="og:type" content="blog"><meta property="og:title" content="NanYinçš„åšå®¢"><meta property="og:url" content="https://nanyiniu.github.io/"><meta property="og:site_name" content="NanYinçš„åšå®¢"><meta property="og:description" content="Was mich nicht umbringt, macht mich starker."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://nanyiniu.github.io/img/og_image.png"><meta property="article:author" content="NanYin"><meta property="article:tag" content="æŠ€æœ¯ ç”Ÿæ´»"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://nanyiniu.github.io"},"headline":"NanYinçš„åšå®¢","image":["https://nanyiniu.github.io/img/og_image.png"],"author":{"@type":"Person","name":"NanYin"},"description":"Was mich nicht umbringt, macht mich starker."}</script><link rel="icon" href="/img/Fail.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?53e5c0e399c6e3142f9ad8241fdba1b1";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/Fail.png" alt="NanYinçš„åšå®¢" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="My Github" href="https://github.com/NanYinIU"><i class="fab fa-github"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">æ ‡ç­¾</a></li><li class="is-active"><a href="#" aria-current="page">åŸºç¡€</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-03-23T19:45:00.000Z" title="2020-03-23T19:45:00.000Z">2020-03-23</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">10 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1513 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/03/24/Lambda%20expression/">lambdaè¡¨è¾¾å¼å­¦ä¹ å’Œåº”ç”¨</a></h1><div class="content"><h1 id="Lambdaè¡¨è¾¾å¼"><a href="#Lambdaè¡¨è¾¾å¼" class="headerlink" title="Lambdaè¡¨è¾¾å¼"></a>Lambdaè¡¨è¾¾å¼</h1><p>Lamdba è¡¨è¾¾å¼æ˜¯Java 8 çš„æ–°ç‰¹æ€§ï¼Œä¹Ÿæ˜¯Java 8 ä¸­æœ€é‡è¦çš„çš„æ–°åŠŸèƒ½ã€‚Lamdabaè¡¨è¾¾å¼ä¿ƒè¿›äº†Javaä½¿ç”¨å‡½æ•°æ–¹å¼è¿›è¡Œç¼–ç¨‹ã€‚</p>
<p>åœ¨è¿›è¡Œè¯­æ³•çš„è®²è§£ä¹‹å‰,éœ€è¦äº†è§£å’ŒLambdaæ¯æ¯ç›¸å…³çš„<code>Function Interface</code>,å¯ä»¥è¯´åªæœ‰å‡½æ•°å¼æ¥å£çš„å­˜åœ¨,æ‰æœ‰lambdaè¡¨è¾¾å¼çš„å­˜åœ¨,æ¢å¥è¯å¯ä»¥è¯´lambdaè¡¨è¾¾å¼æ˜¯å‡½æ•°å¼æ¥å£çš„å®ç°.</p>
<h2 id="å‡½æ•°å¼æ¥å£"><a href="#å‡½æ•°å¼æ¥å£" class="headerlink" title="å‡½æ•°å¼æ¥å£"></a>å‡½æ•°å¼æ¥å£</h2><p>Function æ¥å£å…·æœ‰å•ä¸ªåŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æœ‰å•ä¸ªæŠ½è±¡æ–¹æ³•.å¦‚ <code>Comparable</code> æ¥å£åªæœ‰ä¸€ä¸ªæ–¹æ³• <code>compareTo</code> ç”¨æ¥è¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>Java8å®šä¹‰äº†å‡½æ•°æ¥å£è¢«ç”¨æ¥æ‹“å±•Lamdbaè¡¨è¾¾å¼ã€‚åœ¨ <code>java.util.Function</code> åŒ…ä¸‹æœ‰éå¸¸å¤šçš„å‡½æ•°æ¥å£ã€‚</p>
<p>å¸¸ç”¨çš„æ¥å£åŒ…æ‹¬ï¼›</p>
<table>
<thead>
<tr>
<th>æ¥å£</th>
<th>æŠ½è±¡æ–¹æ³•</th>
<th>ç”¨æ³•</th>
</tr>
</thead>
<tbody><tr>
<td>Function&lt;T,R&gt;</td>
<td>R apply(T t);</td>
<td>æ¥å—Tç±»å‹å‚æ•°,è¿”å›Rç±»å‹ç»“æœ</td>
</tr>
<tr>
<td>Consumer<T></td>
<td>void accept(T t);</td>
<td>æ¥å—Tç±»å‹å‚æ•°,ä¸è¿”å›ç»“æœ</td>
</tr>
<tr>
<td>Predicate<T></td>
<td>boolean test(T t);</td>
<td>æ¥å—Tç±»å‹å‚æ•°,è¿”å›Booleanç»“æœ</td>
</tr>
<tr>
<td>Suppler<T></td>
<td>T get();</td>
<td>æ— å‚æ•°,è¿”å›Tç±»å‹ç»“æœ</td>
</tr>
</tbody></table>
<h3 id="å®šä¹‰å‡½æ•°æ¥å£"><a href="#å®šä¹‰å‡½æ•°æ¥å£" class="headerlink" title="å®šä¹‰å‡½æ•°æ¥å£"></a>å®šä¹‰å‡½æ•°æ¥å£</h3><ol>
<li>ä½¿ç”¨ <code>@FunctionalInterface</code> æ³¨è§£,è¯¥æ³¨è§£ä¸æ˜¯å¿…é¡»çš„,ä½†æ˜¯å¦‚æœæ ‡æ³¨,åˆ™ç¼–è¯‘å™¨ä¼šæ£€æŸ¥è¿™ä¸ªæ¥å£ä¸‹æ˜¯å¦åªæœ‰å•ä¸ªæŠ½è±¡æ–¹æ³•,å¦‚æœä¸æ˜¯ä¼šæŠ¥é”™.</li>
<li>æ–°å¢defaultæ–¹æ³•,æ˜¯ä¸ºäº†åœ¨ç°æœ‰çš„ç±»åº“ä¸­ä¸­æ–°å¢åŠŸèƒ½è€Œä¸å½±å“ä»–ä»¬çš„å®ç°ç±»</li>
<li>æ–°å¢æ¥å£å†…staticæ–¹æ³•,å¯å®šä¹‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªé™æ€æ–¹æ³•,å’Œæ™®é€šçš„é™æ€æ–¹æ³•æ²¡æœ‰åŒºåˆ«,éƒ½æ˜¯<code>æ¥å£å.æ–¹æ³•å</code>è¿›è¡Œè°ƒç”¨</li>
<li>åœ¨å‡½æ•°å¼æ¥å£çš„å®šä¹‰ä¸­æ˜¯åªå…è®¸æœ‰ä¸”åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•(å¿…é¡»)ï¼Œä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ªstaticæ–¹æ³•å’Œdefaultæ–¹æ³•ã€‚</li>
</ol>
<h2 id="Lambdaè¯­æ³•"><a href="#Lambdaè¯­æ³•" class="headerlink" title="Lambdaè¯­æ³•"></a>Lambdaè¯­æ³•</h2><p>ä¸€ä¸ªLambdaè¡¨è¾¾å¼æœ‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paramter -&gt; expression body</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸‹æ˜¯lambdaè¡¨è¾¾å¼çš„å‡ ä¸ªç‰¹æ€§</p>
<ul>
<li><strong>å¯é€‰çš„ç±»å‹æè¿°</strong> - ä¸éœ€è¦å£°æ˜å‚æ•°çš„ç±»å‹ï¼Œç¼–è¯‘å™¨å¯æ ¹æ®å‚æ•°çš„å€¼è¿›è¡Œæ¨æ–­</li>
<li><strong>å¯é€‰çš„å‚æ•°ä¸¤æ—çš„æ‹¬å·</strong> - å£°æ˜å•ä¸ªå‚æ•°çš„æ—¶å€™ä¸éœ€è¦ä½¿ç”¨æ‹¬å·ï¼Œä½†æ˜¯å¦‚ä½•å£°æ˜å¤šä¸ªå‚æ•°ï¼Œæ‹¬å·è¿˜æ˜¯å¿…é¡»çš„ã€‚</li>
<li><strong>å¯é€‰çš„å¤§æ‹¬å·</strong> - å¦‚æœå‡½æ•°ä½“ä¸­åªæœ‰å•è¡Œï¼Œåˆ™ä¸éœ€è¦åœ¨å‡½æ•°ä½“ä¸¤ä¾§æ·»åŠ å¤§æ‹¬å·</li>
<li><strong>å¯é€‰çš„è¿”å›å€¼</strong> - å¦‚æœå‡½æ•°ä¸­åªæœ‰å•è¡Œï¼Œç¼–è¯‘å™¨è‡ªåŠ¨è¿”å›è¿™ä¸ªå•è¡Œçš„è¿”å›å€¼</li>
</ul>
<p>ä¸‹é¢æ ¹æ®å®ä¾‹æ¥çœ‹ä¸Šé¢çš„å››ä¸ªç‰¹æ€§ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Java8Tester</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</span><br><span class="line">      GreetingService greetService1 = message -&gt; System.out.println(<span class="string">"Say:"</span>+message);</span><br><span class="line">      greetService1.sayMessage(<span class="string">"Hello!!"</span>);</span><br><span class="line">      MathOperation add = (<span class="keyword">int</span> a,<span class="keyword">int</span> b) -&gt; a+b;</span><br><span class="line">      MathOperation sub= (a,b) -&gt; a-b;</span><br><span class="line">      MathOperation muti = (a,b) -&gt; &#123;<span class="keyword">return</span> a*b;&#125;;</span><br><span class="line">      System.out.println(<span class="string">"add å‡½æ•°ç»“æœï¼š"</span>+add.operation(<span class="number">2</span>,<span class="number">2</span>));</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">interface</span> <span class="title">GreetingService</span> </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">sayMessage</span><span class="params">(String message)</span></span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">interface</span> <span class="title">MathOperation</span></span>&#123;</span><br><span class="line">       <span class="function"><span class="keyword">int</span> <span class="title">operation</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç»“æœï¼š</span></span><br><span class="line">Say:Hello!!</span><br><span class="line">add å‡½æ•°ç»“æœï¼š<span class="number">4</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹é‡è¦çš„ä¸¤ç‚¹ï¼š</p>
<ul>
<li>Lambda è¡¨è¾¾å¼ä¸»è¦ç”¨æ¥å®šä¹‰åŠŸèƒ½æ¥å£çš„å†…è”å®ç°ï¼Œå¦‚ï¼šä¸€ä¸ªæ¥å£é‡Œåªæœ‰ä¸€ä¸ªæ¥å£æ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­é‡Œé¢æˆ‘ä»¬ä½¿ç”¨äº†å¯¹MathOperationæ¥å£è¿›è¡Œäº†å¤šç§å®ç°ã€‚</li>
<li>Lambda è¡¨è¾¾å¼æ¶ˆé™¤äº†å¯¹åŒ¿åç±»çš„éœ€æ±‚ï¼Œå¦‚<code>new Thread(new Runnable{..})</code> ,ä¸ºJavaæä¾›äº†éå¸¸ç®€å•è€Œå¼ºå¤§çš„å‡½æ•°ç¼–ç¨‹èƒ½åŠ›ã€‚</li>
</ul>
<h2 id="ä½¿ç”¨æ–¹æ³•å¼•ç”¨"><a href="#ä½¿ç”¨æ–¹æ³•å¼•ç”¨" class="headerlink" title="ä½¿ç”¨æ–¹æ³•å¼•ç”¨"></a>ä½¿ç”¨æ–¹æ³•å¼•ç”¨</h2><p>æ–¹æ³•å¼•ç”¨ï¼ˆMethod Refrencesï¼‰å¸®åŠ©é€šè¿‡æ–¹æ³•åç§°æŒ‡å‘æ–¹æ³•ã€‚æ–¹æ³•å¼•ç”¨ä½¿ç”¨ç¬¦å·â€œ::â€è¡¨ç¤ºã€‚æ–¹æ³•å¼•ç”¨å¯ä»¥ç”¨çˆ±æŒ‡å‘å¦‚ä¸‹ç±»å‹çš„æ–¹æ³•ï¼š</p>
<ul>
<li>é™æ€æ–¹æ³•</li>
<li>å®ä¾‹æ–¹æ³•</li>
<li>æ„é€ æ–¹æ³•ä½¿ç”¨newå…³é”®å­—ï¼ˆTreeSet::newï¼‰</li>
</ul>
<p>[æ–¹æ³•å¼•ç”¨]çš„æ ¼å¼æ˜¯ ç±»å::æ–¹æ³•å</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Arrays.stream(objectArray).forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨Lambda"><a href="#ä½¿ç”¨Lambda" class="headerlink" title="ä½¿ç”¨Lambda"></a>ä½¿ç”¨Lambda</h2><blockquote>
<p>ç†Ÿèƒ½ç”Ÿå·§,å¸¸å¸¸ç»ƒä¹ è‚¯å®šèƒ½è®°ä½</p>
</blockquote>
<h3 id="1-åˆ›å»ºThread"><a href="#1-åˆ›å»ºThread" class="headerlink" title="1. åˆ›å»ºThread"></a>1. åˆ›å»ºThread</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ä½¿ç”¨Lambdaåˆ›å»ºThread</span></span><br><span class="line"><span class="comment">// å¯ä»¥çœ‹å‡ºå†…éƒ¨ç›´æ¥åˆ›å»ºäº†Runnableçš„åŒ¿åç±»</span></span><br><span class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ–°å»ºçº¿ç¨‹ã€‚ã€‚"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨lambdaåˆ›å»ºThread</span></span><br><span class="line"><span class="keyword">new</span> Thread(() -&gt; System.out.println(<span class="string">"ä½¿ç”¨Lambdaæ–°å»ºçº¿ç¨‹ã€‚ã€‚"</span>)).start();</span><br></pre></td></tr></table></figure>

<h3 id="2-åˆ—è¡¨è¿­ä»£"><a href="#2-åˆ—è¡¨è¿­ä»£" class="headerlink" title="2. åˆ—è¡¨è¿­ä»£"></a>2. åˆ—è¡¨è¿­ä»£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">// ä¸ä½¿ç”¨Lambda</span></span><br><span class="line"><span class="keyword">for</span> (Integer integer : list) &#123;</span><br><span class="line">    System.out.println(integer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä½¿ç”¨Lambda</span></span><br><span class="line">list.forEach((s) -&gt; System.out.println(s));</span><br><span class="line"><span class="comment">//æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">list.forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="3-Map-amp-Reduce"><a href="#3-Map-amp-Reduce" class="headerlink" title="3. Map&amp;Reduce"></a>3. Map&amp;Reduce</h3><ul>
<li>ä½¿ç”¨Mapå¤„ç†åˆ—è¡¨å†…æ‰€æœ‰å…ƒç´ å…¨éƒ¨åŠ 2</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ä½¿ç”¨Lambda</span></span><br><span class="line"><span class="keyword">for</span> (Integer integer : list) &#123;</span><br><span class="line">    <span class="keyword">int</span> order = integer + <span class="number">2</span>;</span><br><span class="line">    System.out.println(order);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨Lambda</span></span><br><span class="line">list.stream().map((a) -&gt; a + <span class="number">2</span>).forEach(System.out::println);</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨ Map + collect å®Œæˆå¯¹æ¯ä¸ªå…ƒç´ è®¡ç®—åè¿”å›æ–°çš„ç»“æœåˆ—è¡¨</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; newList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ä½¿ç”¨Lambda</span></span><br><span class="line"><span class="keyword">for</span> (Integer integer : list) &#123;</span><br><span class="line">    <span class="keyword">int</span> order = integer + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> result = order / integer;</span><br><span class="line">    newList.add(result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (Integer integer : newList) &#123;</span><br><span class="line">    System.out.println(integer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨Lambda</span></span><br><span class="line">newList = list.stream().map((a) -&gt; (a + <span class="number">2</span>)/a).collect(Collectors.toList());</span><br><span class="line">newList.forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="4-ä½¿ç”¨filterå®ç°å…ƒç´ çš„è¿‡æ»¤"><a href="#4-ä½¿ç”¨filterå®ç°å…ƒç´ çš„è¿‡æ»¤" class="headerlink" title="4. ä½¿ç”¨filterå®ç°å…ƒç´ çš„è¿‡æ»¤"></a>4. ä½¿ç”¨filterå®ç°å…ƒç´ çš„è¿‡æ»¤</h3><p>ä½¿ç”¨lambda,å¯ç›´æ¥ä½¿ç”¨filterè¿›è¡Œå…ƒç´ çš„è¿‡æ»¤</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ä½¿ç”¨lambdaæ—¶</span></span><br><span class="line">List&lt;Integer&gt; list_1 = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (Integer integer : list) &#123;</span><br><span class="line">    <span class="keyword">if</span>(integer != <span class="number">3</span>)&#123;</span><br><span class="line">        list_1.add(integer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ filter è¿›è¡Œè¿‡æ»¤</span></span><br><span class="line">List&lt;Integer&gt; list_2 = list.stream().filter((a) -&gt; a!=<span class="number">3</span>).collect(Collectors.toList());</span><br><span class="line">list_2.forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="5-æ‰§è¡Œå‡½æ•°"><a href="#5-æ‰§è¡Œå‡½æ•°" class="headerlink" title="5. æ‰§è¡Œå‡½æ•°"></a>5. æ‰§è¡Œå‡½æ•°</h3><p>ç¨å¤æ‚çš„å­—ç¬¦ä¸²å¤„ç†,ç”¨lambdaåˆé€‚ä¸è¿‡äº†,ä¸‹é¢çš„ä¾‹å­,åªå°†ç‰¹å®šå­—ç¬¦çš„å­—ç¬¦ä¸²è¿›è¡Œ toUpperCase</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; s = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">s.add(<span class="string">"hello "</span>);</span><br><span class="line">s.add(<span class="string">"world "</span>);</span><br><span class="line">s.add(<span class="string">"!! "</span>);</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; s_1 = s.stream()</span><br><span class="line">        .filter(a -&gt; a.startsWith(<span class="string">"h"</span>) || a.startsWith(<span class="string">"w"</span>))</span><br><span class="line">        .map(String::toUpperCase)</span><br><span class="line">        .collect(Collectors.toList());</span><br><span class="line">s_1.forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="6-ç®—æ•°è¿ç®—"><a href="#6-ç®—æ•°è¿ç®—" class="headerlink" title="6. ç®—æ•°è¿ç®—"></a>6. ç®—æ•°è¿ç®—</h3><p>æ”¯æŒä½¿ç”¨minã€maxç­‰ç›´æ¥å®ç°Comparatorè¿›è¡Œè¿ç®—,å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;Integer&gt; min = list.stream().min(Integer::compareTo);</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæ”¯æŒä½¿ç”¨ IntSummaryStatistics çŠ¶æ€,å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IntSummaryStatistics intSummaryStatistics = list.stream().mapToInt(x -&gt; x).summaryStatistics();</span><br><span class="line">System.out.println(<span class="string">"æœ€å¤§å€¼ï¼š"</span>+intSummaryStatistics.getMax());</span><br><span class="line">System.out.println(<span class="string">"æœ€å°å€¼ï¼š"</span>+intSummaryStatistics.getMin());</span><br><span class="line">System.out.println(<span class="string">"å¹³å‡å€¼ï¼š"</span>+intSummaryStatistics.getAverage());</span><br><span class="line">System.out.println(<span class="string">"æ•°é‡ï¼š"</span>+intSummaryStatistics.getCount());</span><br></pre></td></tr></table></figure>

<h3 id="7-è‡ªå®šä¹‰æ–¹æ³•ä½¿ç”¨Function-Intefaceå®ç°å¤æ‚åŠŸèƒ½"><a href="#7-è‡ªå®šä¹‰æ–¹æ³•ä½¿ç”¨Function-Intefaceå®ç°å¤æ‚åŠŸèƒ½" class="headerlink" title="7. è‡ªå®šä¹‰æ–¹æ³•ä½¿ç”¨Function Intefaceå®ç°å¤æ‚åŠŸèƒ½"></a>7. è‡ªå®šä¹‰æ–¹æ³•ä½¿ç”¨Function Intefaceå®ç°å¤æ‚åŠŸèƒ½</h3><p>Java 8 æä¾›äº†ä¸‰ä¸ªå¸¸ç”¨çš„å‡½æ•°æ¥å£åŒ…æ‹¬ï¼›</p>
<ul>
<li>Function&lt;T,R&gt;</li>
<li>Predicate<T> åˆ¤æ–­</li>
<li>Consumer<T> æ¶ˆè´¹</li>
</ul>
<p>é€šè¿‡å®šä¹‰æ–¹æ³•ä½¿ç”¨è¿™ä¸‰ç±»æ¥å£,èƒ½å®Œæˆæ›´å¤æ‚çš„è°ƒç”¨é€»è¾‘,åœ¨è¿™é‡Œä»…ä»…ä¸¾ä¸€ä¸ªå°ä¾‹å­ğŸŒ°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">List&lt;Integer&gt; <span class="title">functionMethods2</span><span class="params">(List&lt;Integer&gt; a, Function&lt;List&lt;Integer&gt;, List&lt;Integer&gt;&gt; function)</span> </span>&#123;</span><br><span class="line">    a = a.stream()</span><br><span class="line">            .filter(demoFilter(<span class="number">2</span>))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    <span class="keyword">return</span> function.apply(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Predicate&lt;Integer&gt; <span class="title">demoFilter</span><span class="params">(Integer number)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a) -&gt; !a.equals(number);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®¢æˆ·ç«¯è°ƒç”¨</span></span><br><span class="line">JavaTester javaTester = <span class="keyword">new</span> JavaTester();</span><br><span class="line">List&lt;Integer&gt; resList = javaTester.functionMethods2(list, a -&gt; &#123;</span><br><span class="line">        a.add(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-11-08T22:05:00.000Z" title="2018-11-08T22:05:00.000Z">2018-11-08</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">5 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 706 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/11/09/2018-11-08-String%E5%92%8CStringBuffer%E5%92%8CStringBuilder%E7%9A%84%E8%81%94%E7%B3%BB%E5%92%8C%E5%8C%BA%E5%88%AB/">Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«å’Œå…³ç³»</a></h1><div class="content"><h1 id="Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«å’Œå…³ç³»"><a href="#Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«å’Œå…³ç³»" class="headerlink" title="Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«å’Œå…³ç³»"></a>Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«å’Œå…³ç³»</h1><p><code>String</code>å£°æ˜åæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œè€Œ<code>Stringbuffer</code>å’Œ<code>StringBuilder</code>æ˜¯æ•°æ®ç»“æ„æ˜¯å˜é‡ï¼Œæ‰€ä»¥æ¯”Stringåœ¨è¿æ¥å­—ç¬¦æ—¶æ•ˆç‡é«˜ã€‚</p>
<p>å¹¶ä¸”StringBufferå’ŒStringBuilderçš„åŒºåˆ«æ˜¯StringBufferæ˜¯çº¿ç¨‹å®‰å…¨çš„(synchronized) ï¼Œè€ŒStringBuilderæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥é€Ÿåº¦å¤§è‡´æ’è¡Œä¸ºï¼šStringBuilder&gt;StringBuffer&gt;String</p>
<p>ä»¥ä¸Šåªæ˜¯åŸºäºå°è±¡æˆ–è€…è¯´æ˜¯æ­»è®°ç¡¬èƒŒçš„ä¸œè¥¿ï¼Œæ²¡æœ‰çœ‹æºç æ˜¯å¦çœŸçš„æ˜¯è¿™æ ·çš„ã€‚ä¸‹é¢å°±æ¥çœ‹çœ‹String,StringBuilder,StringBufferçš„æºç æ¥çœŸæ­£çš„è®°ä½ã€‚</p>
<h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><p>Stringä¸­çš„concatæ–¹æ³•å®ç°äº†å­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚</p>
<h3 id="å®ä¾‹å˜é‡"><a href="#å®ä¾‹å˜é‡" class="headerlink" title="å®ä¾‹å˜é‡"></a>å®ä¾‹å˜é‡</h3><p>Stringç±»ä¸­æœ‰ä¸¤ä¸ªå®ä¾‹å˜é‡ï¼Œåˆ†åˆ«ä¸ºvalueå’Œhash</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** The value is used for character storage. */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">char</span> value[];</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Cache the hash code for the string */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> hash; <span class="comment">// Default to 0</span></span><br></pre></td></tr></table></figure>

<h3 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h3><p>Stringçš„æ„é€ æ–¹æ³•å¾ˆå¤šï¼Œä½†æ˜¯éƒ½æ¯”è¾ƒç®€å•ï¼Œä¸‹é¢æ¥è¯´æ¯”è¾ƒå¸¸ç”¨çš„å‡ ç§ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“æ–°å»ºä¸€ä¸ªStringå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šé»˜è®¤ä»˜ä¸€ä¸ªç©ºçš„å­—ç¬¦åºåˆ—,è¯·æ³¨æ„ï¼Œç”±äºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ä¸å¿…ä½¿ç”¨æ­¤æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">String</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = <span class="string">""</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// è¿™ä¸ªæ„é€ æ–¹æ³•,ä¼šé»˜è®¤æ–°å»ºä¸€ä¸ªå€¼ä¸ºoriginalçš„å­—ç¬¦ä¸²ã€‚åŒä¸Šï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸å¯å˜çš„ï¼Œå°±æ²¡å¿…è¦è¿™æ ·å£°æ˜ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">String</span><span class="params">(String original)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = original.value;</span><br><span class="line">        <span class="keyword">this</span>.hash = original.hash;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨copyofæ–¹æ³•ç”¨æ¥å¤åˆ¶ä¸€ä¸ªæ–°çš„å­—ç¬¦æ•°ç»„ï¼Œåç»­ä¿®æ”¹å­—ç¬¦æ•°ç»„ï¼Œä¸ä¼šå½±å“åˆ°æ–°å»ºçš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">String</span><span class="params">(<span class="keyword">char</span> value[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.value = Arrays.copyOf(value, value.length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="concatæ–¹æ³•"><a href="#concatæ–¹æ³•" class="headerlink" title="concatæ–¹æ³•"></a>concatæ–¹æ³•</h3><p>ä¸ºä»€ä¹ˆè¯´Stringçš„æ•ˆç‡ä½ï¼Œå°±ä½“ç°åœ¨concatæ‹¼æ¥å­—ç¬¦ä¸²çš„æ—¶å€™æ¯æ¬¡éƒ½è¦è¿”å›ä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> String <span class="title">concat</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> otherLen = str.length();</span><br><span class="line">        <span class="keyword">if</span> (otherLen == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> len = value.length;</span><br><span class="line">        <span class="keyword">char</span> buf[] = Arrays.copyOf(value, len + otherLen);</span><br><span class="line">        str.getChars(buf, len);</span><br><span class="line"><span class="comment">// 	è¿”å›ä¸€ä¸ªæ–°å»ºçš„Stringå¯¹è±¡</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(buf, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="StringBuilder"><a href="#StringBuilder" class="headerlink" title="StringBuilder"></a>StringBuilder</h2><p>StringBuilderç»§æ‰¿äº†AbstractStringBuilderï¼Œå…¶ä¸­çš„å®ä¾‹å˜é‡å’ŒStringä¸­çš„åŸºæœ¬ç›¸åŒï¼Œ</p>
<h3 id="æ„é€ æ–¹æ³•-1"><a href="#æ„é€ æ–¹æ³•-1" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(capacity);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">AbstractStringBuilder(<span class="keyword">int</span> capacity) &#123;</span><br><span class="line">        value = <span class="keyword">new</span> <span class="keyword">char</span>[capacity];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="appendæ–¹æ³•"><a href="#appendæ–¹æ³•" class="headerlink" title="appendæ–¹æ³•"></a>appendæ–¹æ³•</h3><p>å¯ä»¥çœ‹åˆ°ï¼Œå¹¶æ²¡æœ‰æ–°å»ºå¯¹è±¡ï¼Œåªæ˜¯åœ¨æ”¹å˜å¯¹è±¡ä¸­çš„å†…å®¹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> StringBuilder <span class="title">append</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.append(str);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// appendè°ƒç”¨çš„è¿˜æ˜¯çˆ¶ç±»çš„appendæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AbstractStringBuilder <span class="title">append</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (str == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> appendNull();</span><br><span class="line">        <span class="keyword">int</span> len = str.length();</span><br><span class="line">        ensureCapacityInternal(count + len);</span><br><span class="line">        str.getChars(<span class="number">0</span>, len, value, count);</span><br><span class="line"><span class="comment">//	æŠŠvalueæ‰©å®¹åå†æŠŠstråŠ è¿›å»</span></span><br><span class="line">        count += len;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="StringBuffer"><a href="#StringBuffer" class="headerlink" title="StringBuffer"></a>StringBuffer</h2><p>å’ŒStringBuilderä¸€æ ·ï¼Œä¹Ÿæ˜¯ç»§æ‰¿äº†AbstractStringBuilderç±»ï¼Œä½†æ˜¯çœ‹ä¸€ä¸ªappendè¿™ä¸ªæ–¹æ³•çš„æºç å°±èƒ½å¤ŸçŸ¥é“æœ‰ä»€ä¹ˆåŒºåˆ«äº†</p>
<h3 id="appendæ–¹æ³•-1"><a href="#appendæ–¹æ³•-1" class="headerlink" title="appendæ–¹æ³•"></a>appendæ–¹æ³•</h3><p>æ·»åŠ äº†synchronizedå…³é”®å­—ï¼Œä½¿å¾—å˜ä¸ºçº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯ä»£ä»·å°±æ˜¯æ•ˆç‡ä¸å¦‚StringBuilderé«˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> StringBuffer <span class="title">append</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    toStringCache = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">super</span>.append(str);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-10-28T22:05:00.000Z" title="2018-10-28T22:05:00.000Z">2018-10-28</time><span class="level-item"> NanYin </span><span class="level-item">14 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2150 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/29/2018-10-28-Junit4%202/">Junitçš„ä½¿ç”¨å’Œæºç åˆ†æ</a></h1><div class="content"><h1 id="Junitçš„ä½¿ç”¨å’Œæºç åˆ†æ"><a href="#Junitçš„ä½¿ç”¨å’Œæºç åˆ†æ" class="headerlink" title="Junitçš„ä½¿ç”¨å’Œæºç åˆ†æ"></a>Junitçš„ä½¿ç”¨å’Œæºç åˆ†æ</h1><p>Junitæ˜¯ä¸€ä¸ªç¼–å†™å¯é‡å¤æµ‹è¯•çš„Javaæµ‹è¯•æ¡†æ¶ï¼Œä»£ç ç¼–å†™éå¸¸æœ‰æŠ€å·§æ€§ï¼Œå€¼å¾—åå¤é˜…è¯»ã€‚</p>
<h2 id="è·Ÿç€å®˜æ–¹æ–‡æ¡£å­¦ä¹ Junit"><a href="#è·Ÿç€å®˜æ–¹æ–‡æ¡£å­¦ä¹ Junit" class="headerlink" title="è·Ÿç€å®˜æ–¹æ–‡æ¡£å­¦ä¹ Junit"></a>è·Ÿç€å®˜æ–¹æ–‡æ¡£å­¦ä¹ Junit</h2><p>å®˜æ–¹æ–‡æ¡£å¾€å¾€æ˜¯å­¦ä¹ æœ€å¥½çš„èµ„æ–™ã€‚</p>
<h3 id="ç®€å•æµ‹è¯•ä¾‹å­"><a href="#ç®€å•æµ‹è¯•ä¾‹å­" class="headerlink" title="ç®€å•æµ‹è¯•ä¾‹å­"></a>ç®€å•æµ‹è¯•ä¾‹å­</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAdd</span><span class="params">()</span></span>&#123;</span><br><span class="line">        FirstTest firstTest = <span class="keyword">new</span> FirstTest();</span><br><span class="line">        <span class="keyword">int</span> result = firstTest.add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">        <span class="comment">//  assertEquals(4,result); </span></span><br><span class="line">        assertEquals(<span class="number">3</span>,result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &lt;!--</span><br><span class="line">       - å¦‚æœåˆ¤æ–­ä¸ç›¸ç­‰çš„æ—¶å€™ï¼Œåå°æŠ¥é”™ä¿¡æ¯</span><br><span class="line">       - java.lang.AssertionError: </span><br><span class="line">       - Expected :<span class="number">4</span></span><br><span class="line">       - Actual   :<span class="number">3</span></span><br><span class="line">       - &lt;Click to see difference&gt;</span><br><span class="line">     --&gt;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™åªæ˜¯ç®€å•çš„ä¾‹å­ï¼Œå®é™…ä¸Šçš„å•å…ƒæµ‹è¯•è¦æ¯”è¿™ä¸ªå¤æ‚çš„å¤šï¼Œåœ¨å®é™…åº”ç”¨ä¸Šå•å…ƒæµ‹è¯•ååˆ†æœ‰å¿…è¦ï¼Œç¼–å†™åå°ä»£ç æ—¶èƒ½å¤Ÿå°½å¿«æ£€éªŒä»£ç çš„æ­£ç¡®æ€§ã€‚</p>
<h3 id="Assertions-æ–­è¨€"><a href="#Assertions-æ–­è¨€" class="headerlink" title="Assertions æ–­è¨€"></a>Assertions æ–­è¨€</h3><p>Junitæä¾›äº†æ‰€æœ‰åŸºæœ¬æ•°æ®ç±»å‹ï¼ŒObjectç±»å’Œæ•°ç»„çš„æ–­è¨€ï¼Œå‚æ•°æ˜¯ é¢„æœŸå€¼åé¢æ˜¯å®é™…å€¼ï¼Œå¯é€‰é¡¹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯æ–­è¨€å¤±è´¥æ—¶è¾“å‡ºçš„å†…å®¹ï¼Œä¸å…¶ä»–æ–­è¨€ç¨æœ‰ä¸åŒçš„æ˜¯ï¼ŒAssertThatçš„å‚æ•°æ˜¯ å¤±è´¥è¾“å‡ºçš„å†…å®¹ï¼Œå®é™…å€¼å’Œä¸€ä¸ªMatcher<br>Objectã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AssertTests</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertArrayEquals</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">byte</span>[] expected = <span class="string">"trial"</span>.getBytes();</span><br><span class="line">    <span class="keyword">byte</span>[] actual = <span class="string">"trial"</span>.getBytes();</span><br><span class="line">    assertArrayEquals(<span class="string">"failure - byte arrays not same"</span>, expected, actual);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertEquals</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="string">"failure - strings are not equal"</span>, <span class="string">"text"</span>, <span class="string">"text"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertFalse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertFalse(<span class="string">"failure - should be false"</span>, <span class="keyword">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertNotNull</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertNotNull(<span class="string">"should not be null"</span>, <span class="keyword">new</span> Object());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertNotSame</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertNotSame(<span class="string">"should not be same Object"</span>, <span class="keyword">new</span> Object(), <span class="keyword">new</span> Object());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertNull</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertNull(<span class="string">"should be null"</span>, <span class="keyword">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertSame</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Integer aNumber = Integer.valueOf(<span class="number">768</span>);</span><br><span class="line">    assertSame(<span class="string">"should be same"</span>, aNumber, aNumber);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// JUnit Matchers assertThat</span></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertThatBothContainsString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(<span class="string">"albumen"</span>, both(containsString(<span class="string">"a"</span>)).and(containsString(<span class="string">"b"</span>)));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertThatHasItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(Arrays.asList(<span class="string">"one"</span>, <span class="string">"two"</span>, <span class="string">"three"</span>), hasItems(<span class="string">"one"</span>, <span class="string">"three"</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertThatEveryItemContainsString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(Arrays.asList(<span class="keyword">new</span> String[] &#123; <span class="string">"fun"</span>, <span class="string">"ban"</span>, <span class="string">"net"</span> &#125;), everyItem(containsString(<span class="string">"n"</span>)));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Core Hamcrest Matchers with assertThat</span></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertThatHamcrestCoreMatchers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(<span class="string">"good"</span>, allOf(equalTo(<span class="string">"good"</span>), startsWith(<span class="string">"good"</span>)));</span><br><span class="line">    assertThat(<span class="string">"good"</span>, not(allOf(equalTo(<span class="string">"bad"</span>), equalTo(<span class="string">"good"</span>))));</span><br><span class="line">    assertThat(<span class="string">"good"</span>, anyOf(equalTo(<span class="string">"bad"</span>), equalTo(<span class="string">"good"</span>)));</span><br><span class="line">    assertThat(<span class="number">7</span>, not(CombinableMatcher.&lt;Integer&gt; either(equalTo(<span class="number">3</span>)).or(equalTo(<span class="number">4</span>))));</span><br><span class="line">    assertThat(<span class="keyword">new</span> Object(), not(sameInstance(<span class="keyword">new</span> Object())));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAssertTrue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertTrue(<span class="string">"failure - should be true"</span>, <span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¼‚å¸¸æµ‹è¯•"><a href="#å¼‚å¸¸æµ‹è¯•" class="headerlink" title="å¼‚å¸¸æµ‹è¯•"></a>å¼‚å¸¸æµ‹è¯•</h3><p>ä¸‹é¢åˆ†ä¸ºä¸¤ç§æ–¹å¼æ¥å®Œæˆå¯¹å¼‚å¸¸çš„æµ‹è¯•</p>
<h4 id="æœŸå¾…çš„å¼‚å¸¸"><a href="#æœŸå¾…çš„å¼‚å¸¸" class="headerlink" title="æœŸå¾…çš„å¼‚å¸¸"></a>æœŸå¾…çš„å¼‚å¸¸</h4><p>å¦‚ä½•æ£€æµ‹ç¨‹åºæ˜¯å¦å¦‚æœŸçš„æŠ›å‡ºå¼‚å¸¸ï¼Œjunitå¯ä»¥ä½¿ç”¨æ³¨è§£çš„å‚æ•°æ¥å®ç°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>(expected = IndexOutOfBoundsException.class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testException</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">new</span> ArrayList&lt;Integer&gt;().get(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ·±å…¥çš„å¼‚å¸¸"><a href="#æ·±å…¥çš„å¼‚å¸¸" class="headerlink" title="æ·±å…¥çš„å¼‚å¸¸"></a>æ·±å…¥çš„å¼‚å¸¸</h4><p>ä¸Šè¿°æ–¹æ³•å¯¹äºç®€å•çš„æƒ…å†µå¾ˆæœ‰ç”¨ï¼Œä½†å®ƒæœ‰å…¶å±€é™æ€§ã€‚ä¾‹å¦‚ï¼Œæ‚¨æ— æ³•åœ¨å¼‚å¸¸ä¸­æµ‹è¯•æ¶ˆæ¯çš„å€¼ï¼Œä¹Ÿæ— æ³•åœ¨æŠ›å‡ºå¼‚å¸¸åæµ‹è¯•åŸŸå¯¹è±¡çš„çŠ¶æ€</p>
<ul>
<li>try/catch è¯­å¥</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTryCatch</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> ArrayList&lt;Integer&gt;().get(<span class="number">0</span>);</span><br><span class="line">        fail(<span class="string">"å¤±è´¥ä¿¡æ¯"</span>);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IndexOutOfBoundsException indexOutOfBoundsExecption)&#123;</span><br><span class="line">          assertThat(indexOutOfBoundsExecption.getMessage(), is(<span class="string">"Index: 0, Size: 0"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>rule è§„åˆ™</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Rule</span></span><br><span class="line"><span class="keyword">public</span> ExpectedException thrown = ExpectedException.none();</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testExpectException</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;Object&gt; list = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</span><br><span class="line">    thrown.expect(IndexOutOfBoundsException.class);</span><br><span class="line">    thrown.expectMessage(<span class="string">"Index: 0, Size: 0"</span>);</span><br><span class="line">    list.get(<span class="number">0</span>); <span class="comment">// execution will never get past this line</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Matchers-and-assertThat-åŒ¹é…å™¨å’ŒassertThat"><a href="#Matchers-and-assertThat-åŒ¹é…å™¨å’ŒassertThat" class="headerlink" title="Matchers and assertThat [ åŒ¹é…å™¨å’ŒassertThat ]"></a>Matchers and assertThat [ åŒ¹é…å™¨å’ŒassertThat ]</h3><p>æ–°åŠ å…¥äº†<code>assertThat</code>æ–­è¨€æœºåˆ¶ assertThat([value], [matcher statement]);</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">assertThat(x, is(<span class="number">3</span>));</span><br><span class="line">assertThat(x, is(not(<span class="number">4</span>)));</span><br><span class="line">assertThat(responseString, either(containsString(<span class="string">"color"</span>)).or(containsString(<span class="string">"colour"</span>)));</span><br><span class="line">assertThat(myList, hasItem(<span class="string">"3"</span>));</span><br></pre></td></tr></table></figure>

<p><code>assertThat</code> æ›´å…·æœ‰å¯è¯»æ€§å’Œå¯è¾“å…¥æ€§ï¼Œå¹¶ä¸”æœ‰ç»„åˆæ€§ï¼Œå°±åƒ <code>is(not(4))</code> ä»»ä½•Macherséƒ½å¯ä»¥ç»„åˆèµ·æ¥ä½¿ç”¨</p>
<p>ä»¥å‰çš„assertEqualsç­‰ä¹Ÿæ˜¯å¯ä»¥ç”¨çš„ï¼Œ<code>assertThat</code> åœ¨ä½¿ç”¨Matchersçš„æ—¶å€™éœ€è¦ä½¿ç”¨ <code>import static org.hamcrest.CoreMatchers.*;</code>æ¥å¼•ç”¨ã€‚é‡Œé¢çš„æ–¹æ³•éå¸¸å¤šã€‚ã€‚</p>
<h2 id="junitæºç è·Ÿè¯»"><a href="#junitæºç è·Ÿè¯»" class="headerlink" title="junitæºç è·Ÿè¯»"></a>junitæºç è·Ÿè¯»</h2><h3 id="ä½¿ç”¨junitæµç¨‹"><a href="#ä½¿ç”¨junitæµç¨‹" class="headerlink" title="ä½¿ç”¨junitæµç¨‹"></a>ä½¿ç”¨junitæµç¨‹</h3><h4 id="ä½¿ç”¨ç»§æ‰¿è‡ªTestCaseç±»"><a href="#ä½¿ç”¨ç»§æ‰¿è‡ªTestCaseç±»" class="headerlink" title="ä½¿ç”¨ç»§æ‰¿è‡ªTestCaseç±»"></a>ä½¿ç”¨ç»§æ‰¿è‡ªTestCaseç±»</h4><p>ä¸‹é¢é€šè¿‡è¿è¡Œjunitçš„è‡ªå¸¦çš„testï¼Œæºç¨‹åºä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Some simple tests.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleTest</span> <span class="keyword">extends</span> <span class="title">TestCase</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> fValue1;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> fValue2;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        fValue1 = <span class="number">2</span>;</span><br><span class="line">        fValue2 = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Test <span class="title">suite</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">           * the type safe way</span></span><br><span class="line"><span class="comment">           *</span></span><br><span class="line"><span class="comment">          TestSuite suite= new TestSuite();</span></span><br><span class="line"><span class="comment">          suite.addTest(</span></span><br><span class="line"><span class="comment">              new SimpleTest("add") &#123;</span></span><br><span class="line"><span class="comment">                   protected void runTest() &#123; testAdd(); &#125;</span></span><br><span class="line"><span class="comment">              &#125;</span></span><br><span class="line"><span class="comment">          );</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">          suite.addTest(</span></span><br><span class="line"><span class="comment">              new SimpleTest("testDivideByZero") &#123;</span></span><br><span class="line"><span class="comment">                   protected void runTest() &#123; testDivideByZero(); &#125;</span></span><br><span class="line"><span class="comment">              &#125;</span></span><br><span class="line"><span class="comment">          );</span></span><br><span class="line"><span class="comment">          return suite;</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * the dynamic way</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TestSuite(SimpleTest.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAdd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = fValue1 + fValue2;</span><br><span class="line">        <span class="comment">// forced failure result == 5</span></span><br><span class="line">        assertTrue(result == <span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> unused;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDivideByZero</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> zero = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">8</span> / zero;</span><br><span class="line">        unused = result; <span class="comment">// avoid warning for not using result</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testEquals</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        assertEquals(<span class="number">12</span>, <span class="number">12</span>);</span><br><span class="line">        assertEquals(<span class="number">12L</span>, <span class="number">12L</span>);</span><br><span class="line">        assertEquals(<span class="keyword">new</span> Long(<span class="number">12</span>), <span class="keyword">new</span> Long(<span class="number">12</span>));</span><br><span class="line"></span><br><span class="line">        assertEquals(<span class="string">"Size"</span>, <span class="number">12</span>, <span class="number">13</span>);</span><br><span class="line">        assertEquals(<span class="string">"Capacity"</span>, <span class="number">12.0</span>, <span class="number">11.99</span>, <span class="number">0.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        junit.textui.TestRunner.run(suite());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥çœ‹mainæ–¹æ³•ï¼Œä½¿ç”¨ <code>junit.textui.TestRunner.run(suite());</code> ä½¿ç”¨TestRunnerè¿è¡Œtestã€‚é¦–å…ˆå…ˆæ¥çœ‹suiteæ–¹æ³•ï¼Œæœ‰ä¸¤ç§æ–¹æ³•</p>
<ol>
<li>é™æ€çš„,éœ€è¦æ‰‹åŠ¨åœ¨testSuiteä¸­æ·»åŠ testã€‚</li>
<li>åŠ¨æ€çš„ï¼Œé™æ€éœ€è¦å®ç°TestCaseçš„runTestæ–¹æ³•ã€‚è€ŒåŠ¨æ€çš„åªéœ€è¦è¿”å› TestSuite(SimpleTest.class);ï¼Œä¸‹é¢æ¥çœ‹è¿™ä¸ªTestSuiteç±»</li>
</ol>
<p>testSuiteå®é™…ä¸Šå°±æ˜¯è¿è¡Œtestçš„é›†åˆï¼Œä½¿ç”¨vectoræ¥å­˜å‚¨test,å…¶ä¸­è¿™é‡Œä½¿ç”¨åˆ°çš„TestSuiteæ„é€ æ–¹æ³•æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TestSuite</span><span class="params">(<span class="keyword">final</span> Class&lt;?&gt; theClass)</span> </span>&#123;</span><br><span class="line">        addTestsFromTestCase(theClass);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addTestsFromTestCase</span><span class="params">(<span class="keyword">final</span> Class&lt;?&gt; theClass)</span> </span>&#123;</span><br><span class="line">        fName = theClass.getName();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            getTestConstructor(theClass); <span class="comment">// Avoid generating multiple error messages</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            addTest(warning(<span class="string">"Class "</span> + theClass.getName() + <span class="string">" has no public constructor TestCase(String name) or TestCase()"</span>));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// è¿™ä¸ªç±»æ˜¯å¦æ˜¯publicçš„ å¦‚æœä¸æ˜¯ å‘å‡ºwarning ï¼Œå¹¶ä¸”fail(message)</span></span><br><span class="line">        <span class="keyword">if</span> (!Modifier.isPublic(theClass.getModifiers())) &#123;</span><br><span class="line">            addTest(warning(<span class="string">"Class "</span> + theClass.getName() + <span class="string">" is not public"</span>));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Class&lt;?&gt; superClass = theClass;</span><br><span class="line">        List&lt;String&gt; names = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line"><span class="comment">//        è¿™å¥è¯è¯´æ˜çš„æ˜¯å¦‚æœè¿™ä¸ªç±»æ˜¯superClassçš„è¶…ç±»ï¼Œæˆ–è€…æ¥å£å°±è¿”å›trueï¼Œå¦åˆ™è¿”å›false</span></span><br><span class="line">        <span class="keyword">while</span> (Test.class.isAssignableFrom(superClass)) &#123;</span><br><span class="line"><span class="comment">//            å¦‚æœæ˜¯true  æœ‰é¡ºåºçš„è¿”å›å£°æ˜çš„æ–¹æ³•</span></span><br><span class="line">            <span class="keyword">for</span> (Method each : MethodSorter.getDeclaredMethods(superClass)) &#123;</span><br><span class="line">                addTestMethod(each, names, theClass);</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            è·å¾—superclassç±»ï¼Œé€’å½’çš„æŸ¥æ‰¾testæ–¹æ³•</span></span><br><span class="line">            superClass = superClass.getSuperclass();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (fTests.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            addTest(warning(<span class="string">"No tests found in "</span> + theClass.getName()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åæåˆ°çš„ <code>fTests.size() == 0</code> è¿™é‡Œä¼šå‘ç”Ÿwarning ç„¶åfailã€‚è¿™ä¸ªfTests å·²ç»å†å‰é¢å£°æ˜<br>äº†ï¼Œå£°æ˜æ–¹æ³•æ˜¯ï¼š<code>private Vector&lt;Test&gt; fTests = new Vector&lt;Test&gt;(10);</code> </p>
<p>åœ¨å¯¹æ¯ä¸ªå£°æ˜çš„æ–¹æ³•å¾ªç¯çš„æ—¶å€™ï¼Œä½¿ç”¨åˆ° <code>addTestMethod</code> æ–¹æ³•ï¼Œæ¥å¯¹æ¯ä¸ªæ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addTestMethod</span><span class="params">(Method m, List&lt;String&gt; names, Class&lt;?&gt; theClass)</span> </span>&#123;</span><br><span class="line"><span class="comment">// è·å¾—æ–¹æ³•åå¦‚æœlistæ•°ç»„ä¸­å·²ç»åŒ…å«è¿™ä¸ªæ–¹æ³•åï¼Œå°±ç›´æ¥é€€å‡º</span></span><br><span class="line">        String name = m.getName();</span><br><span class="line">        <span class="keyword">if</span> (names.contains(name)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!isPublicTestMethod(m)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (isTestMethod(m)) &#123;</span><br><span class="line">                addTest(warning(<span class="string">"Test method isn't public: "</span> + m.getName() + <span class="string">"("</span> + theClass.getCanonicalName() + <span class="string">")"</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// æŠŠè¿™ä¸ªæ–¹æ³•ååŠ å…¥åˆ°names Listä¸­</span></span><br><span class="line">        names.add(name);</span><br><span class="line">        addTest(createTest(theClass, name));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//å†æ¥çœ‹å¤–å±‚çš„addTestæ–¹æ³• æŠŠæ‹¥æœ‰çš„testæ–¹æ³•æ”¾åˆ°fTestsä¸­ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addTest</span><span class="params">(Test test)</span> </span>&#123;</span><br><span class="line">        fTests.add(test);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨createTestæ¥é’ˆå¯¹testæ–¹æ³•åˆ›å»ºä¸€ä¸ªTestç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">public</span> Test <span class="title">createTest</span><span class="params">(Class&lt;?&gt; theClass, String name)</span> </span>&#123;</span><br><span class="line">        Constructor&lt;?&gt; constructor;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            constructor = getTestConstructor(theClass);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> warning(<span class="string">"Class "</span> + theClass.getName() + <span class="string">" has no public constructor TestCase(String name) or TestCase()"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Object test;</span><br><span class="line">	<span class="comment">// é€šè¿‡åå°„æ–¹å¼è·å¾—æ–¹æ³•çš„testå®ä¾‹</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (constructor.getParameterTypes().length == <span class="number">0</span>) &#123;</span><br><span class="line">                test = constructor.newInstance(<span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">                <span class="keyword">if</span> (test <span class="keyword">instanceof</span> TestCase) &#123;</span><br><span class="line">                    ((TestCase) test).setName(name);<span class="comment">//å¦‚æœç»§æ‰¿TestCase</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                test = constructor.newInstance(<span class="keyword">new</span> Object[]&#123;name&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> (warning(<span class="string">"Cannot instantiate test case: "</span> + name + <span class="string">" ("</span> + Throwables.getStacktrace(e) + <span class="string">")"</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> (warning(<span class="string">"Exception in constructor: "</span> + name + <span class="string">" ("</span> + Throwables.getStacktrace(e.getTargetException()) + <span class="string">")"</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> (warning(<span class="string">"Cannot access test case: "</span> + name + <span class="string">" ("</span> + Throwables.getStacktrace(e) + <span class="string">")"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (Test) test;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä»¥ä¸Šçš„æ­¥éª¤è·å¾—äº†è¿™ä¸ªç±»ä¸­åŠå…¶çˆ¶ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•çš„Testã€‚</p>
<p>ä½¿ç”¨testRunner.runè¿è¡Œtest</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        junit.textui.TestRunner.run(suite());</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨TestRunnerçš„runçš„é™æ€æ–¹æ³• è¿”å›ä¸€ä¸ªTestResultç”¨æ¥è¿”å›ç»“æœã€‚   </span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">public</span> TestResult <span class="title">run</span><span class="params">(Test test)</span> </span>&#123;</span><br><span class="line">        TestRunner runner = <span class="keyword">new</span> TestRunner();</span><br><span class="line">        <span class="keyword">return</span> runner.doRun(test);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨runnerçš„doRunæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> TestResult <span class="title">doRun</span><span class="params">(Test test)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> doRun(test, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> TestResult <span class="title">doRun</span><span class="params">(Test suite, <span class="keyword">boolean</span> wait)</span> </span>&#123;</span><br><span class="line"><span class="comment">//      ç”¨æ¥è¿”å›ç»“æœçš„TestResult</span></span><br><span class="line">        TestResult result = createTestResult();</span><br><span class="line">	<span class="comment">// æ³¨å†Œä¸€ä¸ªTestListener</span></span><br><span class="line">        result.addListener(fPrinter);</span><br><span class="line">        <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line"><span class="comment">//      test.runæ–¹æ³•</span></span><br><span class="line">        suite.run(result);</span><br><span class="line">        <span class="keyword">long</span> endTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">long</span> runTime = endTime - startTime;</span><br><span class="line">        fPrinter.print(result, runTime);</span><br><span class="line">        pause(wait);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡ŒTestçš„æ ¸å¿ƒæ–¹æ³• è¿”å›TestResultè¿”å›ç»“æœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Creates the TestResult to be used for the test run.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> TestResult <span class="title">createTestResult</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> TestResult();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">addListener</span><span class="params">(TestListener listener)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// protected List&lt;TestListener&gt; fListeners;</span></span><br><span class="line">        fListeners.add(listener);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// suite.run() fTestsä¸­çš„æ¯ä¸€ä¸ªtest </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(TestResult result)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Test each : fTests) &#123;</span><br><span class="line">            <span class="keyword">if</span> (result.shouldStop()) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            runTest(each, result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Runs the test case and collects the results in TestResult.</span></span><br><span class="line"><span class="comment"> * è°ƒç”¨testResultçš„runæ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(TestResult result)</span> </span>&#123;</span><br><span class="line">    result.run(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œtest</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(<span class="keyword">final</span> TestCase test)</span> </span>&#123;</span><br><span class="line">        startTest(test);</span><br><span class="line">        Protectable p = <span class="keyword">new</span> Protectable() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">protect</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                test.runBare();<span class="comment">//æ‰§è¡ŒrunBareæ–¹æ³•æ‰§è¡Œtestç”¨ä¾‹</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        runProtected(test, p);</span><br><span class="line"></span><br><span class="line">        endTest(test);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startTest</span><span class="params">(Test test)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> count = test.countTestCases();</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            fRunTests += count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (TestListener each : cloneListeners()) &#123;</span><br><span class="line">            each.startTest(test);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨resultPriterä¸­ä½¿ç”¨ç»§æ‰¿TestListenerä¸­çš„startTestæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startTest</span><span class="params">(Test test)</span> </span>&#123;</span><br><span class="line">        getWriter().print(<span class="string">"."</span>);<span class="comment">//è¿è¡Œä¸€ä¸ªåˆ™åŠ ä¸€ä¸ªç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (fColumn++ &gt;= <span class="number">40</span>) &#123;</span><br><span class="line">            getWriter().println();</span><br><span class="line">            fColumn = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿è¡Œä¸€ä¸ªç©ºçš„æµ‹è¯•åºåˆ—</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runBare</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Throwable exception = <span class="keyword">null</span>;</span><br><span class="line">	<span class="comment">// è®¾ç½®è£…ç½®ã€‚æ¯”å¦‚æ‰“å¼€ç½‘ç»œè¿æ¥ç­‰ï¼Œåœ¨æ‰§è¡Œæµ‹è¯•ä¹‹å‰è°ƒç”¨æ–¹æ³•ã€‚</span></span><br><span class="line">        setUp();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">	    <span class="comment">// çœ‹ä¸‹é¢çš„runTestæ–¹æ³• </span></span><br><span class="line">            runTest();<span class="comment">//æ‰§è¡Œtest</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable running) &#123;</span><br><span class="line">            exception = running;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                tearDown();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable tearingDown) &#123;</span><br><span class="line">                <span class="keyword">if</span> (exception == <span class="keyword">null</span>) exception = tearingDown;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (exception != <span class="keyword">null</span>) <span class="keyword">throw</span> exception;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">runTest</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        assertNotNull(<span class="string">"TestCase.fName cannot be null"</span>, fName); <span class="comment">// Some VMs crash when calling getMethod(null,null);</span></span><br><span class="line">        Method runMethod = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            runMethod = getClass().getMethod(fName, (Class[]) <span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            fail(<span class="string">"Method \""</span> + fName + <span class="string">"\" not found"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">	<span class="comment">// .......... runMethod.invoke(this); æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">            runMethod.invoke(<span class="keyword">this</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ–¹æ³•æ‰§è¡Œé”™è¯¯ï¼Œä¼šè§¦å‘è¿™ä¸ªå¼‚å¸¸ ä¼šè¿ç»­è¢«ä¸Šå±‚æ•æ‰åˆ°</span></span><br><span class="line">            e.fillInStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> e.getTargetException();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.fillInStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œåˆ™æœ€ç»ˆå°†è¢«runProtectedä¸­çš„try/catchæ•æ‰åˆ°åè¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runProtected</span><span class="params">(<span class="keyword">final</span> Test test, Protectable p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        p.protect();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (AssertionFailedError e) &#123;</span><br><span class="line">    <span class="comment">// éªŒè¯å¤±è´¥ï¼Œæ·»åŠ ä¸€æ¡å¤±è´¥ä¿¡æ¯</span></span><br><span class="line">        addFailure(test, e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ThreadDeath e) &#123; <span class="comment">// don't catch ThreadDeath by accident</span></span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        addError(test, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä»¥ä¸Šçš„æ­¥éª¤æ‰§è¡Œå®Œä¸€ä¸ªtestã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-10-25T22:05:00.000Z" title="2018-10-25T22:05:00.000Z">2018-10-25</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">6 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 861 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/26/2018-10-24-Java%E4%B8%ADDeque%E5%8F%8A%E5%85%B6%E5%AD%90%E7%B1%BB/">Javaä¸­Dequeå’ŒArrayDeque</a></h1><div class="content"><h1 id="Javaä¸­Dequeå’ŒArrayDeque"><a href="#Javaä¸­Dequeå’ŒArrayDeque" class="headerlink" title="Javaä¸­Dequeå’ŒArrayDeque"></a>Javaä¸­Dequeå’ŒArrayDeque</h1><h2 id="Dequeç±»"><a href="#Dequeç±»" class="headerlink" title="Dequeç±»"></a>Dequeç±»</h2><p>ä¸€ä¸ªçº¿æ€§çš„å¯åœ¨åŒç«¯æ’å…¥ã€åˆ é™¤èŠ‚ç‚¹çš„ç»“æ„ã€‚ä»–åå­—æ—¶Dequeï¼Œå®é™…ä¸Šæ—¶â€œdouble ended queueâ€çš„ç®€å†™ï¼›</p>
<h2 id="ArrayDequeç±»"><a href="#ArrayDequeç±»" class="headerlink" title="ArrayDequeç±»"></a>ArrayDequeç±»</h2><p>å¯¹äºArrayDequeä¸­çš„æ•°ç»„ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„å¾ªç¯æ•°ç»„ï¼Œæ‰€è°“å¾ªç¯æ˜¯æŒ‡å…ƒç´ åˆ°æ•°ç»„å°¾ä¹‹åå¯ä»¥æ¥ç€ä»æ•°ç»„å¤´å¼€å§‹ï¼Œæ•°ç»„çš„é•¿åº¦ã€ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´ éƒ½ä¸headå’Œtailè¿™ä¸¤ä¸ªå˜é‡æœ‰å…³</p>
<h3 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h3><p>ArrayDequeå°±åƒä»–çš„åå­—ä¸€æ ·ï¼Œä½¿ç”¨Arrayæ•°ç»„æ¥å®ç°Dequeç»“æ„ã€‚æ„é€ æ–¹æ³•å’Œä»¥å‰æåˆ°çš„ArrayListç›¸ä¼¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayDeque</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–çš„æ•°ç»„å¤§å°æ˜¯16</span></span><br><span class="line">        elements = <span class="keyword">new</span> Object[<span class="number">16</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayDeque</span><span class="params">(<span class="keyword">int</span> numElements)</span> </span>&#123;</span><br><span class="line">        allocateElements(numElements);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayDeque</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">        allocateElements(c.size());</span><br><span class="line">        <span class="comment">// addAllæ–¹æ³•å°±æ˜¯ä¸ºc è¿›è¡Œforå¾ªç¯æ·»åŠ </span></span><br><span class="line">        addAll(c);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ·»åŠ å’Œç§»é™¤æ–¹æ³•"><a href="#æ·»åŠ å’Œç§»é™¤æ–¹æ³•" class="headerlink" title="æ·»åŠ å’Œç§»é™¤æ–¹æ³•"></a>æ·»åŠ å’Œç§»é™¤æ–¹æ³•</h3><ul>
<li>addæ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å‰é¢æ·»åŠ å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯åœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®ä¸ŠåŠ å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (e == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">            <span class="comment">// åœ¨å‰é¢æ·»åŠ çš„æ—¶å€™ï¼Œhead-1 çš„ä½ç½®ä¸Šæ’å…¥ e</span></span><br><span class="line">        elements[head = (head - <span class="number">1</span>) &amp; (elements.length - <span class="number">1</span>)] = e;</span><br><span class="line">        <span class="keyword">if</span> (head == tail)</span><br><span class="line">            doubleCapacity();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (e == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">            æ·»åŠ åˆ°ä¸‹ä¸€ä¸ªä½ç½®</span><br><span class="line">        elements[tail] = e;</span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">         * å¦‚æœå½“å‰æ·»åŠ ä½ç½®çš„ä¸‹ä¸€ä¸ªä½ç½® ä¸ä¸Š é•¿åº¦-1 </span></span><br><span class="line"><span class="comment">         *ï¼ˆå› ä¸ºé•¿åº¦éƒ½æ˜¯2çš„å€æ•°ï¼Œæ‰€ä»¥-1ä¹‹åï¼Œ2è¿›åˆ¶åå‡ ä½éƒ½æ˜¯1ï¼Œä¿è¯è´Ÿæ•°çš„æ—¶å€™ä¹Ÿèƒ½å¤Ÿæ‰¾åˆ°æ­£ç¡®çš„ç´¢å¼•ï¼‰</span></span><br><span class="line"><span class="comment">         * å¦‚æœtailå’Œheadç›¸ç­‰è¯´æ˜æ•°ç»„æ»¡äº†ï¼Œéœ€è¦æ‰©å®¹</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> ( (tail = (tail + <span class="number">1</span>) &amp; (elements.length - <span class="number">1</span>)) == head)</span><br><span class="line">            doubleCapacity();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†è¿™ä¸¤ç§æ–¹æ³•ï¼Œé˜Ÿåˆ—æˆ–è€…æ ˆçš„æ–¹æ³•éƒ½å¯ä»¥è½»æ¾å®ç°äº†ã€‚</p>
<p>åœ¨è¿›è¡Œå¢åŠ å…ƒç´ çš„æ—¶å€™æ¶‰åŠåˆ° <code>doubleCapacity</code> è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨æ¥æ‰©å……æ•°ç»„çš„å®¹é‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doubleCapacity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">assert</span> head == tail;</span><br><span class="line">        <span class="keyword">int</span> p = head;</span><br><span class="line">        <span class="keyword">int</span> n = elements.length;</span><br><span class="line">        <span class="keyword">int</span> r = n - p; <span class="comment">// headå³è¾¹å…ƒç´ çš„ä¸ªæ•°</span></span><br><span class="line">        <span class="keyword">int</span> newCapacity = n &lt;&lt; <span class="number">1</span>; <span class="comment">// æ‰©å……ä¸ºåŸæ¥çš„2å€</span></span><br><span class="line">        <span class="keyword">if</span> (newCapacity &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Sorry, deque too big"</span>);</span><br><span class="line">        Object[] a = <span class="keyword">new</span> Object[newCapacity]; <span class="comment">//åˆ›å»ºæ–°æ•°ç»„</span></span><br><span class="line">        Systkkem.arraycopy(elements, p, a, <span class="number">0</span>, r); </span><br><span class="line">        System.arraycopy(elements, <span class="number">0</span>, a, r, p);<span class="comment">// ä¸¤éƒ¨copyæ•°ç»„ç›¸å½“äºä» head -&gt; tail é‡æ–°æ’åºäº†</span></span><br><span class="line">        elements = a;</span><br><span class="line">        head = <span class="number">0</span>;</span><br><span class="line">        tail = n;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>removeæ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> removeFirst();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">removeFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        E x = pollFirst();</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">pollFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> h = head;</span><br><span class="line">        <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">        E result = (E) elements[h];</span><br><span class="line">        <span class="comment">// Element is null if deque empty</span></span><br><span class="line">        <span class="keyword">if</span> (result == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        elements[h] = <span class="keyword">null</span>;     <span class="comment">// Must null out slot</span></span><br><span class="line">        <span class="comment">// æŠŠelementçš„å¤´éƒ¨ä½ç½®ç½®ç©ºåï¼Œå°†headå‘å‰ç§»</span></span><br><span class="line">        head = (h + <span class="number">1</span>) &amp; (elements.length - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>toArrayæ–¹æ³•</li>
</ul>
<p>toArrayæ–¹æ³•ä¸»è¦æ˜¯æ–¹ä¾¿è¾“å‡ºã€‚ç”¨æ¥çœŸæ­£çš„æŒ‰ç…§é€»è¾‘é¡ºåºï¼Œè¿›è¡Œç‰©ç†é‡æ’ï¼Œå®ç°æ–¹æ³•å’ŒdoubleCapacityå®ç°ç›¸åŒã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object[] toArray() &#123;</span><br><span class="line">        <span class="keyword">return</span> copyElements(<span class="keyword">new</span> Object[size()]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> &lt;T&gt; T[] copyElements(T[] a) &#123;</span><br><span class="line">        <span class="keyword">if</span> (head &lt; tail) &#123;</span><br><span class="line">         <span class="comment">// å¦‚æœé¡ºåºæ­£å¸¸</span></span><br><span class="line">            System.arraycopy(elements, head, a, <span class="number">0</span>, size());</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (head &gt; tail) &#123;</span><br><span class="line">         <span class="comment">// å¦åˆ™å°†headå³ä¾§çš„å…ˆcopyåˆ°æ•°ç»„ä¸­ï¼Œåœ¨copyå‰©ä¸‹çš„</span></span><br><span class="line">            <span class="keyword">int</span> headPortionLen = elements.length - head;</span><br><span class="line">            System.arraycopy(elements, head, a, <span class="number">0</span>, headPortionLen);</span><br><span class="line">            System.arraycopy(elements, <span class="number">0</span>, a, headPortionLen, tail);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>sizeæ–¹æ³•</li>
</ul>
<p>å’Œå¾ˆå¤šæ•°æ®ç»“æ„ç±»ä¸åŒçš„æ˜¯ï¼Œä»–çš„sizeå¹¶ä¸æ˜¯ä¾é æœ¬èº«çš„å˜é‡å­—æ®µè¿›è¡Œç»´æŠ¤ï¼Œè€Œæ˜¯é€šè¿‡sizeæ–¹æ³•è®¡ç®—è€Œæ¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> (tail - head) &amp; (elements.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“ä¸€ä¸‹ï¼ŒArrayDequeå®ç°äº†åŒç«¯é˜Ÿåˆ—çš„ç‰¹ç‚¹ï¼Œèƒ½å¤Ÿå®Œæˆæ ˆå’Œé˜Ÿåˆ—çš„åŠŸèƒ½ï¼Œæ•ˆç‡æ¯”åŒæ ·ç»§æ‰¿Dequeçš„LinkedListæ•ˆç‡é«˜ï¼Œå› ä¸ºåœ¨ArrayDequeä¸­çš„è®¡ç®—å¤§éƒ¨åˆ†ä¸ºä½è¿ç®—ã€‚ArrayDequeé€»è¾‘ä¸Šå¾ªç¯çš„æ•°ç»„ï¼Œä½†å®é™…ä¸Šå¹¶ä¸æ˜¯ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-10-17T22:05:00.000Z" title="2018-10-17T22:05:00.000Z">2018-10-17</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">3 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 494 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/18/2018-10-17-Java%E4%B8%AD%E7%9A%84%E6%A0%88%E5%92%8C%E9%98%9F%E5%88%97/">Javaä¸­çš„æ ˆå’Œé˜Ÿåˆ—</a></h1><div class="content"><!-- vim-markdown-toc GFM -->

<ul>
<li><a href="#javaä¸­çš„æ ˆå’Œé˜Ÿåˆ—">javaä¸­çš„æ ˆå’Œé˜Ÿåˆ—</a><ul>
<li><a href="#stack-æ ˆ">Stack æ ˆ</a><ul>
<li><a href="#pushæ–¹æ³•å’Œpopæ–¹æ³•">pushæ–¹æ³•å’Œpopæ–¹æ³•</a></li>
<li><a href="#peekæ–¹æ³•">peekæ–¹æ³•</a></li>
</ul>
</li>
<li><a href="#queue-é˜Ÿåˆ—">Queue é˜Ÿåˆ—</a><ul>
<li><a href="#offer-æ–¹æ³•å’Œ-pullæ–¹æ³•">offer æ–¹æ³•å’Œ pullæ–¹æ³•</a></li>
<li><a href="#addæ–¹æ³•å’Œremoveæ–¹æ³•">addæ–¹æ³•å’Œremoveæ–¹æ³•</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- vim-markdown-toc -->

<h1 id="javaä¸­çš„æ ˆå’Œé˜Ÿåˆ—"><a href="#javaä¸­çš„æ ˆå’Œé˜Ÿåˆ—" class="headerlink" title="javaä¸­çš„æ ˆå’Œé˜Ÿåˆ—"></a>javaä¸­çš„æ ˆå’Œé˜Ÿåˆ—</h1><h2 id="Stack-æ ˆ"><a href="#Stack-æ ˆ" class="headerlink" title="Stack æ ˆ"></a>Stack æ ˆ</h2><p>æ ˆæ˜¯ä¸€ä¸ªåè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ï¼Œæœ‰è¿™æ ·çš„æ•°æ®ç»“æ„åŠŸèƒ½çš„è¿˜æœ‰Dequç±»ï¼Œæ¨èä½¿ç”¨Dequ</p>
<h3 id="pushæ–¹æ³•å’Œpopæ–¹æ³•"><a href="#pushæ–¹æ³•å’Œpopæ–¹æ³•" class="headerlink" title="pushæ–¹æ³•å’Œpopæ–¹æ³•"></a>pushæ–¹æ³•å’Œpopæ–¹æ³•</h3><p>pushæ–¹æ³•æ˜¯å‘æ ˆé¡¶æ”¾å€¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public E push(E item) &#123;</span><br><span class="line">&#x2F;&#x2F; è¿™é‡Œè°ƒç”¨çˆ¶ç±»Vectorçš„addElementæ–¹æ³•</span><br><span class="line">        addElement(item);</span><br><span class="line"></span><br><span class="line">        return item;</span><br><span class="line">    &#125;</span><br><span class="line">&#x2F;&#x2F; addElementæ–¹æ³•æ˜¯åŠ é”çš„æ–¹æ³• è°ƒç”¨elementå®é™…ä¸Šå°±æ˜¯æ•°ç»„é•¿åº¦åŠ ä¸€å¹¶ä¸”åœ¨è¯¥é—®ä¹‹ä¸Šä»˜å€¼</span><br><span class="line">public synchronized void addElement(E obj) &#123;</span><br><span class="line">        modCount++;</span><br><span class="line">        ensureCapacityHelper(elementCount + 1);</span><br><span class="line">        elementData[elementCount++] &#x3D; obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>popæ–¹æ³•æ˜¯åœ¨å°†æ ˆé¡¶çš„å€¼å‡ºæ ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; åŒæ ·åŠ é”çš„æ–¹æ³• è°ƒç”¨æ–¹æ³• ç§»é™¤åœ¨æ•°ç»„æœ€åä½ç½®çš„å…ƒç´ </span><br><span class="line">public synchronized E pop() &#123;</span><br><span class="line">        E       obj;</span><br><span class="line">        int     len &#x3D; size();</span><br><span class="line"></span><br><span class="line">        obj &#x3D; peek();</span><br><span class="line">        removeElementAt(len - 1);</span><br><span class="line"></span><br><span class="line">        return obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="peekæ–¹æ³•"><a href="#peekæ–¹æ³•" class="headerlink" title="peekæ–¹æ³•"></a>peekæ–¹æ³•</h3><p>peekæ–¹æ³•æ˜¯çœ‹ä¸€ä¸‹æ ˆé¡¶å…ƒç´ çš„å€¼ï¼Œä½†ä¸åšä»»ä½•æ“ä½œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public synchronized E peek() &#123;</span><br><span class="line">        int     len &#x3D; size();</span><br><span class="line"></span><br><span class="line">        if (len &#x3D;&#x3D; 0)</span><br><span class="line">            throw new EmptyStackException();</span><br><span class="line">        return elementAt(len - 1);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™å‡ ä¸ªæ–¹æ³•å’ŒlinkedListç±»ä¸­çš„å¯¹åº”çš„æ–¹æ³•éå¸¸åƒï¼Œæ‰€ä»¥å…¶å®LindedListä¹Ÿå¯ä»¥å½“ä½œæ ˆç”¨ã€‚</p>
<h2 id="Queue-é˜Ÿåˆ—"><a href="#Queue-é˜Ÿåˆ—" class="headerlink" title="Queue é˜Ÿåˆ—"></a>Queue é˜Ÿåˆ—</h2><p>é˜Ÿåˆ—å’Œæ ˆç›¸åï¼Œæ˜¯ä¸€ä¸ªå…ˆè¿›åå‡ºçš„æ•°æ®ç»“æ„ï¼Œæƒ³æˆç°å®ä¸­çš„æ’é˜Ÿå†æ˜ç™½ä¸è¿‡äº†ã€‚</p>
<h3 id="offer-æ–¹æ³•å’Œ-pullæ–¹æ³•"><a href="#offer-æ–¹æ³•å’Œ-pullæ–¹æ³•" class="headerlink" title="offer æ–¹æ³•å’Œ pullæ–¹æ³•"></a>offer æ–¹æ³•å’Œ pullæ–¹æ³•</h3><p>offeræ–¹æ³•å¯ä»¥å°†å…ƒç´ æ”¾å…¥é˜Ÿåˆ—å½“ä¸­ï¼Œpullå¯ä»¥å°†å…ƒç´ ä»å¤´éƒ¨ç§»é™¤ã€‚</p>
<h3 id="addæ–¹æ³•å’Œremoveæ–¹æ³•"><a href="#addæ–¹æ³•å’Œremoveæ–¹æ³•" class="headerlink" title="addæ–¹æ³•å’Œremoveæ–¹æ³•"></a>addæ–¹æ³•å’Œremoveæ–¹æ³•</h3><p>addå’Œremoveæ–¹æ³•åˆ†åˆ«è°ƒç”¨offerå’Œpullæ–¹æ³•ï¼Œä¸åŒçš„æ˜¯ï¼Œå¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œaddæ–¹æ³•ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œofferæ–¹æ³•ä¼šè¿”å›nullã€‚å¦‚æœé˜Ÿåˆ—ç©ºäº†ï¼Œremoveæ–¹æ³•ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œpullæ–¹æ³•ä¼šè¿”å›nullã€‚</p>
<p>ä»¥åä¼šæåŠé˜Ÿåˆ—çš„å®ç°ç±»ä»¥åŠDequç›¸å…³ç±»ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-10-15T22:05:00.000Z" title="2018-10-15T22:05:00.000Z">2018-10-15</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">3 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 447 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/16/2018-10-15-Enum%E7%B1%BB%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%8B%93%E5%B1%95/">Enumæšä¸¾ç±»åˆ†æå’Œç›¸å…³æ‹“å±•</a></h1><div class="content"><h1 id="Enumæšä¸¾ç±»åˆ†æå’Œç›¸å…³æ‹“å±•"><a href="#Enumæšä¸¾ç±»åˆ†æå’Œç›¸å…³æ‹“å±•" class="headerlink" title="Enumæšä¸¾ç±»åˆ†æå’Œç›¸å…³æ‹“å±•"></a>Enumæšä¸¾ç±»åˆ†æå’Œç›¸å…³æ‹“å±•</h1><p>å…¶å®æˆ‘è®¤ä¸ºä½¿ç”¨æšä¸¾ç±»å°±æ˜¯å¯¹ä½¿ç”¨å¸¸é‡çš„æ‰©å……ï¼Œä¾‹å¦‚ç±»ä¸­ä½¿ç”¨ç±»å‹ï¼Œåˆ†ç±»ç›¸åŒçš„ç±»å˜é‡çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æšä¸¾ç±»æ¥æ›¿æ¢æ‰ã€‚</p>
<p>å‚è€ƒäº†ç½‘ä¸Šçš„æ–‡ç« ï¼Œå¤§è‡´æœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œç¬¬ä¸€æ˜¯ç¡®å®šä¼ å…¥çš„å‚æ•°ç±»å‹ã€‚è€Œä¸æ˜¯å½¢å‚æ˜¯intç±»å‹ï¼Œéšä¾¿ä¸€ä¸ªintç±»å‹å°±èƒ½å¤Ÿæ»¡è¶³ã€‚ç¬¬äºŒæ˜¯å¯¹æ¯”staticé™æ€å˜é‡æ›´èƒ½å¤Ÿç¡®å®šå˜é‡çš„æ„ä¹‰ã€‚ä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­æ¥çœ‹ã€‚</p>
<h2 id="Enumç±»å®ä¾‹"><a href="#Enumç±»å®ä¾‹" class="headerlink" title="Enumç±»å®ä¾‹"></a>Enumç±»å®ä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* åˆ—ä¸¾ç®€å•çš„è¡Œé©¶å·¥å…· */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> trafficTool &#123;</span><br><span class="line">    BIKE,CAR,BUS,TRAIN,AIRPLANE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrafficToolTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">chooseTool</span><span class="params">(TrafficTool trafficTool)</span></span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (trafficTool)&#123;</span><br><span class="line">            <span class="keyword">case</span> BIKE:</span><br><span class="line">                System.out.println(<span class="string">"è‡ªè¡Œè½¦"</span>);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CAR:</span><br><span class="line">                System.out.println(<span class="string">"æ±½è½¦"</span>);<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        TrafficToolTest trafficToolTest = <span class="keyword">new</span> TrafficToolTest();</span><br><span class="line">        trafficToolTest.chooseTool(TrafficTool.BIKE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å’Œæ™®é€šçš„ç±»ä¸€æ ·ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥æ·»åŠ æ„é€ æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SPRING(<span class="string">"æ˜¥å¤©"</span>),SUMMER(<span class="string">"å¤å¤©"</span>),FALL(<span class="string">"ç§‹å¤©"</span>),WINTER(<span class="string">"å†¬å¤©"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">SeasonEnum(String name)&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">String <span class="title">getName</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç»§æ‰¿</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> SeasonEnum &#123;</span><br><span class="line">    SPRING(<span class="string">"æ˜¥å¤©"</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">comm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"è¿™æ˜¯æ˜¥å¤©"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,SUMMER(<span class="string">"å¤å¤©"</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">comm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"è¿™æ˜¯å¤å¤©"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,FALL(<span class="string">"ç§‹å¤©"</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">comm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"è¿™æ˜¯å†¬å¤©"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,WINTER(<span class="string">"å†¬å¤©"</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">comm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"è¿™æ˜¯å†¬å¤©"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">    SeasonEnum(String name)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">comm</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šæ˜¯æšä¸¾ç±»çš„åŸºæœ¬ä½¿ç”¨ã€‚</p>
<h2 id="EnumMap-å’Œ-EnumSet"><a href="#EnumMap-å’Œ-EnumSet" class="headerlink" title="EnumMap å’Œ EnumSet"></a><code>EnumMap</code> å’Œ <code>EnumSet</code></h2><p><code>public class EnumMap&lt;K extends Enum&lt;K&gt;, V&gt; extends AbstractMap&lt;K, V&gt;</code> è¿™æ˜¯å…³äºEnumMapçš„ç»§æ‰¿å…³ç³»ã€‚<br>å¯ä»¥å‘ç°è¿™æ˜¯keyä¸ºæšä¸¾ç±»çš„ä¸€ä¸ªMapã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ç®€å•åˆ›å»ºï¼Œä»¥åå°±å¯ä»¥å®ç°æšä¸¾ç±»çš„å¤šç§å¤ç”¨ */</span></span><br><span class="line">EnumMap&lt;SeasonEnum,Integer&gt; enumIntegerEnumMap = <span class="keyword">new</span> EnumMap&lt;SeasonEnum, Integer&gt;(SeasonEnum.class);</span><br><span class="line">Set&lt;SeasonEnum&gt; set = enumIntegerEnumMap.keySet();</span><br><span class="line">enumIntegerEnumMap.put(SeasonEnum.SPRING,<span class="number">1</span>);</span><br><span class="line">System.out.println(enumIntegerEnumMap.get(SeasonEnum.SPRING));</span><br></pre></td></tr></table></figure>

<p><code>EnumSet</code> ç›¸å¯¹äº <code>EnumMap</code> ç­‰åŒäº <code>hashSet</code> ç›¸å¯¹äº <code>HashMap</code> çš„å­˜åœ¨ï¼Œå¾ˆå¥½ç†è§£ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-10-15T22:05:00.000Z" title="2018-10-15T22:05:00.000Z">2018-10-15</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">5 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 810 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/16/2018-10-15-HashSet%E5%92%8CHashTable%E7%9A%84%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">HashSetå’ŒHashTableçš„çš„æºç åˆ†æ</a></h1><div class="content"><!-- TOC depthFrom:1 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

<ul>
<li><a href="#hashsetå’Œhashtableçš„çš„æºç åˆ†æ">HashSetå’ŒHashTableçš„çš„æºç åˆ†æ</a><ul>
<li><a href="#hashset">HashSet</a><ul>
<li><a href="#hashsetç»“æ„æºç ">HashSetç»“æ„æºç </a></li>
<li><a href="#hashsetçš„åŸºæœ¬æ–¹æ³•">HashSetçš„åŸºæœ¬æ–¹æ³•</a></li>
<li><a href="#hashsetçš„iteratorå’Œcontainsæ–¹æ³•">HashSetçš„Iteratorå’Œcontainsæ–¹æ³•</a></li>
</ul>
</li>
<li><a href="#hashtable">HashTable</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->

<h1 id="HashSetå’ŒHashTableçš„çš„æºç åˆ†æ"><a href="#HashSetå’ŒHashTableçš„çš„æºç åˆ†æ" class="headerlink" title="HashSetå’ŒHashTableçš„çš„æºç åˆ†æ"></a>HashSetå’ŒHashTableçš„çš„æºç åˆ†æ</h1><h2 id="HashSet"><a href="#HashSet" class="headerlink" title="HashSet"></a>HashSet</h2><p>HashSetå…¶å®å°±æ˜¯ä½¿ç”¨HashMapæ¥å®ç°çš„ï¼Œæ–¹æ³•éƒ½æ˜¯ä¾é Hash Mapçš„æ–¹æ³•ã€‚å¦‚hashSetæ„é€ ï¼ŒhashSetçš„æ·»åŠ ç­‰æ“ä½œã€‚è¿™æ ·èƒ½å¤Ÿå®ç°hashsetå»é‡ã€‚å› ä¸ºhashMapçš„keyä¸èƒ½é‡å¤ã€‚è¿™æ ·å°±èƒ½çœ‹ä¸Šç¯‡ï¼Œå½“hashMapé‡åˆ°keyå€¼é‡å¤çš„å¤„ç†ã€‚</p>
<h3 id="HashSetç»“æ„æºç "><a href="#HashSetç»“æ„æºç " class="headerlink" title="HashSetç»“æ„æºç "></a>HashSetç»“æ„æºç </h3><p>HashSetçš„ç»“æ„å°±ç›¸å½“äºHashMapåªå°†keyå€¼putè¿›å»ï¼Œä½†æ˜¯Valueå€¼å´ä¸ºç©ºçš„new Objectã€‚å¯ä»¥çœ‹ä½œä¸ºåªæœ‰keyçš„HashMap.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å¯ä»¥çœ‹åˆ°hashSetçš„è¿™å‡ ä¸ªæ„é€ æ–¹æ³•å’ŒHashMapæ¯æ¯ç›¸å…³ */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> HashMap&lt;E,Object&gt; map;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    map = <span class="keyword">new</span> HashMap&lt;&gt;(Math.max((<span class="keyword">int</span>) (c.size()/.<span class="number">75f</span>) + <span class="number">1</span>, <span class="number">16</span>));</span><br><span class="line">    addAll(c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line">    map = <span class="keyword">new</span> HashMap&lt;&gt;(initialCapacity, loadFactor);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    map = <span class="keyword">new</span> HashMap&lt;&gt;(initialCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HashSet(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor, <span class="keyword">boolean</span> dummy) &#123;</span><br><span class="line">    map = <span class="keyword">new</span> LinkedHashMap&lt;&gt;(initialCapacity, loadFactor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HashSetçš„åŸºæœ¬æ–¹æ³•"><a href="#HashSetçš„åŸºæœ¬æ–¹æ³•" class="headerlink" title="HashSetçš„åŸºæœ¬æ–¹æ³•"></a>HashSetçš„åŸºæœ¬æ–¹æ³•</h3><p>addå’Œremoveå’Œsizeç­‰åŸºæœ¬æ–¹æ³•éƒ½æ˜¯è°ƒç”¨HashMapçš„</p>
<p>å¦‚addæ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* è¿™é‡Œçš„PRESENTç­‰äºnew Object() */</span></span><br><span class="line">       <span class="keyword">return</span> map.put(e, PRESENT)==<span class="keyword">null</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="HashSetçš„Iteratorå’Œcontainsæ–¹æ³•"><a href="#HashSetçš„Iteratorå’Œcontainsæ–¹æ³•" class="headerlink" title="HashSetçš„Iteratorå’Œcontainsæ–¹æ³•"></a>HashSetçš„Iteratorå’Œcontainsæ–¹æ³•</h3><p>åŒæ ·çš„ä¹Ÿæ˜¯è°ƒç”¨çš„HashMapçš„åŸºæœ¬æ–¹æ³•ï¼Œä½†æ˜¯éœ€è¦å…ˆå¾—åˆ°Mapçš„keySeté›†åˆ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> map.keySet().iterator();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> map.containsKey(o);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="HashTable"><a href="#HashTable" class="headerlink" title="HashTable"></a>HashTable</h2><p>é¦–å…ˆHashTableå’ŒHashMapçš„ç»“æ„ç±»ä¼¼ã€‚ä½†æ˜¯æœ‰æœ€é‡è¦çš„åŒºåˆ«å°±æ˜¯HashTableæ˜¯synchronizedçš„ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚åœ¨ä»–çš„åŸºæœ¬æ–¹æ³•å‰éƒ½æœ‰synchronizedé”æ‰€é™åˆ¶ã€‚</p>
<p>ç»“æ„å°±ä¸çœ‹äº†ï¼Œåªçœ‹ä¸€ä¸ªPutæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* å…¶å®å¤§è‡´å’ŒHashMapæ˜¯ç±»ä¼¼çš„ä¹Ÿæ˜¯ä½¿ç”¨Entryä½œä¸ºåŸºæœ¬ç»“æ„ */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">     <span class="comment">// Make sure the value is not null</span></span><br><span class="line">     <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123;</span><br><span class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">// Makes sure the key is not already in the hashtable.</span></span><br><span class="line">     Entry&lt;?,?&gt; tab[] = table;</span><br><span class="line">     <span class="keyword">int</span> hash = key.hashCode();</span><br><span class="line">     <span class="comment">/* è¿™é‡Œçš„0x7FFFFFFF æ˜¯32-bitçš„intçš„æœ€å¤§å€¼ */</span></span><br><span class="line">     <span class="keyword">int</span> index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">     <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">     Entry&lt;K,V&gt; entry = (Entry&lt;K,V&gt;)tab[index];</span><br><span class="line">     <span class="comment">/* å¦‚æœè¿™ä¸ªentryå­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯é”®å€¼é‡å¤ */</span></span><br><span class="line">     <span class="keyword">for</span>(; entry != <span class="keyword">null</span> ; entry = entry.next) &#123;</span><br><span class="line">         <span class="keyword">if</span> ((entry.hash == hash) &amp;&amp; entry.key.equals(key)) &#123;</span><br><span class="line">             V old = entry.value;</span><br><span class="line">             entry.value = value;</span><br><span class="line">             <span class="keyword">return</span> old;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">    <span class="comment">/* å¦åˆ™æ·»åŠ EntryèŠ‚ç‚¹ */</span></span><br><span class="line">     addEntry(hash, key, value, index);</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line"></span><br><span class="line">    Entry&lt;?,?&gt; tab[] = table;</span><br><span class="line">    <span class="keyword">if</span> (count &gt;= threshold) &#123;</span><br><span class="line">      <span class="comment">/* å¦‚æœå½“å‰countå¤§äºé˜ˆå€¼çš„å¤§å° é‡æ–°ç”Ÿæˆtable sizeå’Œhashå€¼ */</span></span><br><span class="line">        <span class="comment">// Rehash the table if the threshold is exceeded</span></span><br><span class="line">        rehash();</span><br><span class="line"></span><br><span class="line">        tab = table;</span><br><span class="line">        hash = key.hashCode();</span><br><span class="line">        index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Creates the new entry.</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    Entry&lt;K,V&gt; e = (Entry&lt;K,V&gt;) tab[index];</span><br><span class="line">    tab[index] = <span class="keyword">new</span> Entry&lt;&gt;(hash, key, value, e);</span><br><span class="line">    count++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºHashTableå’ŒHashMapçš„ç»“æ„è¿˜æ˜¯æœ‰å·®å¼‚çš„ï¼ŒHashMapæ˜¯çºµå‘çš„åˆ—è¡¨å½“å‡ºç°ç›¸åŒçš„hashå€¼çš„æ—¶å€™ï¼Œæ‰©å±•å‡ºæ¨ªå‘åˆ—è¡¨ï¼Œå½“æ¨ªå‘çš„åˆ—è¡¨åˆ°è¾¾ä¸€å®šçš„é•¿åº¦çš„æ—¶å€™ï¼Œè¿™ä¸ªæ¨ªå‘çš„é“¾è¡¨å°±ä¼šè‡ªåŠ¨æ•´ç†æˆçº¢é»‘æ ‘çš„å½¢å¼ï¼Œè€ŒhashTableä¸å­˜åœ¨æ¨ªå‘çš„è¿™ç§ç»“æ„çš„ï¼Œå½“count&gt;=é˜ˆå€¼çš„æ—¶å€™å°±ä¼šæŠŠHashé‡ç½®ï¼Œä½¿ä¹‹ä¸ä¼šå‡ºç°hashå€¼é‡å¤çš„æƒ…å†µã€‚å¯ä»¥è¯´hashTableæ¯”è¾ƒhashMapçš„ç»“æ„æ›´ç®€å•ï¼Œä½†æ˜¯æ•ˆç‡ä¼šæ¯”HashMapçš„ä½ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-10-10T22:05:00.000Z" title="2018-10-10T22:05:00.000Z">2018-10-10</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">15 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2270 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/11/2018-10-10-hashmap%E7%9A%84%E6%BA%90%E7%A0%81%E6%9F%A5%E7%9C%8B/">HashMapçš„æºç æŸ¥çœ‹</a></h1><div class="content"><h1 id="HashMapçš„æºç æŸ¥çœ‹"><a href="#HashMapçš„æºç æŸ¥çœ‹" class="headerlink" title="HashMapçš„æºç æŸ¥çœ‹"></a>HashMapçš„æºç æŸ¥çœ‹</h1><p>HashMapæ˜¯å¸¸è§çš„,ä»¥K-Vå­˜å‚¨çš„æ•°æ®ç»“æ„.</p>
<p>åœ¨çœ‹æºç ä¹‹å‰ï¼Œå…ˆéœ€è¦äº†è§£HashMapçš„ç»“æ„æƒ…å†µï¼Œå‰é¢çš„ä»£ç ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸»ä½“æ•°æ®æ˜¯ç”±Node&lt;K,V&gt;ç»„æˆçš„æ•°ç»„æ„æˆï¼Œè€ŒNodeè¿˜æœ‰æŒ‡å‘ä¸‹ä¸€èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå‚è€ƒä¸‹å›¾ï¼š</p>
<p><img src="https://raw.githubusercontent.com/NanYinIU/PicRoom/master/img/20191218133708.png" alt="å›¾1"></p>
<h2 id="NodeèŠ‚ç‚¹"><a href="#NodeèŠ‚ç‚¹" class="headerlink" title="NodeèŠ‚ç‚¹"></a>NodeèŠ‚ç‚¹</h2><p>é¦–å…ˆçœ‹åˆ°hashmapä¸­çš„nodeç±»ç»§æ‰¿äº†map.Entry&lt;k,v&gt;ç»“æ„ï¼Œæœ‰ç±»å‹ä¸ºKçš„keyå’Œç±»å‹ä¸ºVçš„valueï¼›å…¶æ¬¡nodeæ˜¯ä¸€ä¸ªå•é“¾è¡¨ç»“æ„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;</span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    V value;</span><br><span class="line">    <span class="comment">// æŒ‡å‘ä¸‹ä¸€èŠ‚ç‚¹çš„æŒ‡é’ˆ</span></span><br><span class="line">    Node&lt;K,V&gt; next;</span><br><span class="line">    Node(<span class="keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> K <span class="title">getKey</span><span class="params">()</span>        </span>&#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">getValue</span><span class="params">()</span>      </span>&#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> key + <span class="string">"="</span> + value; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">setValue</span><span class="params">(V newValue)</span> </span>&#123;</span><br><span class="line">        V oldValue = value;</span><br><span class="line">        value = newValue;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) &#123;</span><br><span class="line">            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span><br><span class="line">            <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;</span><br><span class="line">                Objects.equals(value, e.getValue()))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="HashMapæºç "><a href="#HashMapæºç " class="headerlink" title="HashMapæºç "></a>HashMapæºç </h2><h3 id="åŸºæœ¬å±æ€§"><a href="#åŸºæœ¬å±æ€§" class="headerlink" title="åŸºæœ¬å±æ€§"></a>åŸºæœ¬å±æ€§</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å®é™…ä¸Šç»“æ„å°±æ˜¯ä¸€ä¸ªç±»å‹ä¸ºNodeçš„æ•°ç»„,ä½¿ç”¨transient é˜²æ­¢å¯¹æ•´ä¸ªtableå…¨éƒ¨åºåˆ—åŒ– */</span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Holds cached entrySet(). Note that AbstractMap fields are used</span></span><br><span class="line"><span class="comment"> * for keySet() and values().</span></span><br><span class="line"><span class="comment"> * å¾—åˆ°entryset</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The number of key-value mappings contained in this map.</span></span><br><span class="line"><span class="comment">   mapçš„å¤§å°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ“ä½œæ¬¡æ•° */</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> modCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* é˜ˆå€¼ï¼Œå¦‚æœè¶…è¿‡ä¸´ç•Œå€¼å°±ä¼šè‡ªåŠ¨æ‰©å……æ•°ç»„ */</span></span><br><span class="line"><span class="keyword">int</span> threshold;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŠ è½½å› å­  */</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span> loadFactor;</span><br></pre></td></tr></table></figure>

<h3 id="hashMapçš„ä¸‰ä¸ªæ„é€ æ–¹æ³•"><a href="#hashMapçš„ä¸‰ä¸ªæ„é€ æ–¹æ³•" class="headerlink" title="hashMapçš„ä¸‰ä¸ªæ„é€ æ–¹æ³•"></a>hashMapçš„ä¸‰ä¸ªæ„é€ æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ç¬¬ä¸€ä¸ªå‚æ•° æ˜¯é»˜è®¤çš„åˆå§‹åŒ–é˜ˆå€¼å¤§å°ï¼Œç¬¬äºŒä¸ªæ˜¯åŠ è½½å› å­å¤§å° */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">    <span class="comment">/* å¦‚æœåˆ¶å®šçš„åˆå§‹åŒ–é˜ˆå€¼å°äº0 */</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal initial capacity: "</span> +</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal load factor: "</span> +</span><br><span class="line">                                           loadFactor);</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = loadFactor;</span><br><span class="line">    <span class="keyword">this</span>.threshold = tableSizeFor(initialCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½¿ç”¨thisè°ƒç”¨ä¸Šé¢çš„æ–¹æ³• */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨é»˜è®¤çš„é˜ˆå€¼å’Œå› å­ï¼Œå¤§å°åˆ†åˆ«ä¸º16å’Œ0.75</span></span><br><span class="line"><span class="comment"> * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the default initial capacity</span></span><br><span class="line"><span class="comment"> * (16) and the default load factor (0.75).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="hashMapçš„æ–¹æ³•æºç "><a href="#hashMapçš„æ–¹æ³•æºç " class="headerlink" title="hashMapçš„æ–¹æ³•æºç "></a>hashMapçš„æ–¹æ³•æºç </h2><p>åœ¨å¤§è‡´äº†è§£å®ŒHashMapçš„ç»“æ„åï¼Œé€šè¿‡æŸ¥çœ‹putæ–¹æ³•ï¼Œæ¥åˆ†æå…ƒç´ æ˜¯å¦‚ä½•æ”¾åˆ°è¿™ç§ç»“æ„ä¸­çš„ã€‚å¤§è‡´æ­¥éª¤å¯ä»¥å‚è€ƒä¸‹å›¾ï¼š</p>
<p><img src="https://raw.githubusercontent.com/NanYinIU/PicRoom/master/img/20191218134303.png" alt="å›¾2"></p>
<h3 id="putæ–¹æ³•"><a href="#putæ–¹æ³•" class="headerlink" title="putæ–¹æ³•"></a>putæ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* è°ƒç”¨putValæ–¹æ³• */</span></span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements Map.put and related methods</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hash hash for key keyçš„hashç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> key the key keyå€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> value the value to put valueå€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> onlyIfAbsent if true, don't change existing value å¦‚æœæ˜¯true ä¸æ”¹å˜å½“å‰å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> evict if false, the table is in creation mode. å¦‚æœæ˜¯falseï¼Œé‚£ä¹ˆtableå°±å±äºåˆ›å»ºæ¨¡å¼ ï¼ˆï¼Ÿï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> previous value, or null if none</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">               <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="comment">/* å½“Mapä¸ºç©ºçš„æ—¶å€™  è¿™æ—¶å€™tabä¸º16ä¹Ÿå°±æ˜¯nä¸º16*/</span></span><br><span class="line">    <span class="comment">/* è¿™æ˜¯å½“mapä¸­çš„å†…å®¹ä¸ºç©ºçš„æ—¶å€™</span></span><br><span class="line"><span class="comment">     * newCap = DEFAULT_INITIAL_CAPACITY;</span></span><br><span class="line"><span class="comment">     * newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="comment">/* å¦‚æœå½“å‰tabçš„length&amp;hashå€¼å†tabåˆ—è¡¨ä¸­ä¸é‡å¤ */</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">    <span class="comment">/* æ–°å»ºä¸€ä¸ªnoede å†tab[i]çš„ä½ç½®ä¸Š */</span></span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        <span class="comment">/* å½“æ·»åŠ é‡å¤çš„keyçš„æ—¶å€™ è¿™æ—¶å€™hashå’Œkeyçš„å€¼éƒ½ç›¸ç­‰ï¼Œå°±ç›¸å½“äºä¸æ·»åŠ  */</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">            ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            e = p;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">        <span class="comment">/* å¦‚æœeæ˜¯treeNodeçš„æ—¶å€™  */</span></span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// å°†æ–°å€¼æ·»åŠ åˆ°pçš„åé¢</span></span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                    <span class="comment">/* å¦‚æœå½“å‰åˆ—è¡¨ä¸­çš„é•¿åº¦å¤§äºç­‰äº 8-1 çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªåˆ—è¡¨æ•´ç†æˆæ ‘å½¢ç»“æ„ */</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="comment">/* å¦‚æœå½“å‰sizeå¤§äºthresholdçš„æ—¶å€™æ‰©å……table */</span></span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åœ¨çœ‹getæ–¹æ³•ä¹‹å‰å…ˆçœ‹å’Œputæ–¹æ³•æ¯æ¯ç›¸å…³çš„resizeæ–¹æ³•"><a href="#åœ¨çœ‹getæ–¹æ³•ä¹‹å‰å…ˆçœ‹å’Œputæ–¹æ³•æ¯æ¯ç›¸å…³çš„resizeæ–¹æ³•" class="headerlink" title="åœ¨çœ‹getæ–¹æ³•ä¹‹å‰å…ˆçœ‹å’Œputæ–¹æ³•æ¯æ¯ç›¸å…³çš„resizeæ–¹æ³•"></a>åœ¨çœ‹getæ–¹æ³•ä¹‹å‰å…ˆçœ‹å’Œputæ–¹æ³•æ¯æ¯ç›¸å…³çš„resizeæ–¹æ³•</h4><p>å¦‚æœ <code>hash&amp;length-1</code> çš„å€¼é‡å¤çš„è¯ï¼Œè¯´æ˜ä½ç½®å†²çªï¼Œé¦–å…ˆä¼šæ·»åŠ åœ¨è¿™ä¸ªä½ç½®å…ƒç´ åé¢ï¼Œå¦‚æœå¤§å°è¶…è¿‡ <code>TREEIFY_THRESHOLD - 1</code> çš„æ—¶å€™è‡ªåŠ¨ä¸ºè¿™åˆ—æ•´ç†æˆæ ‘å½¢çŠ¶ã€‚è¿™æ ·å°±ä¼šå˜ä¸ºæ•°ç»„å’Œæ¨ªå‘åˆ—è¡¨æˆ–æ ‘çš„ç»„åˆç»“æ„ã€‚</p>
<p>åœ¨æœªé‡å¤hashçš„å‰æä¸‹ï¼Œå¦‚æœtableçš„å¤§å°è¶…è¿‡è®¾ç½®çš„ <code>threshold</code> çš„å¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘ <code>resize</code> æ–¹æ³•ã€‚åœ¨resizeæ—¶ä¼šå°†HashMapä¸­çš„æ‰€æœ‰å…ƒç´ è¿›è¡Œé‡æ–°æ’åˆ—ï¼Œä»¥ä¾¿ä¸é˜²æ²»åˆ†å¸ƒä¸å‡åŒ€çš„æƒ…å†µå‘ç”Ÿã€‚ä¸‹é¢å°±æ¥çœ‹çœ‹resizeæ–¹æ³•çš„ä»£ç ç»“æ„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">        Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">        <span class="keyword">int</span> oldCap = (oldTab == <span class="keyword">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">        <span class="keyword">int</span> oldThr = threshold;</span><br><span class="line">        <span class="keyword">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">                threshold = Integer.MAX_VALUE;</span><br><span class="line">                <span class="keyword">return</span> oldTab;</span><br><span class="line">            &#125; <span class="comment">//newcapæ˜¯oldcapçš„2å€</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                     oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">                newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">            newCap = oldThr;</span><br><span class="line">        <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">            newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">            newThr = (<span class="keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">float</span> ft = (<span class="keyword">float</span>)newCap * loadFactor;</span><br><span class="line">            newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                      (<span class="keyword">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">        &#125;</span><br><span class="line">        threshold = newThr;</span><br><span class="line">        <span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"rawtypes"</span>,<span class="string">"unchecked"</span>&#125;)</span><br><span class="line">        Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> Node[newCap];</span><br><span class="line">        table = newTab;</span><br><span class="line">        <span class="keyword">if</span> (oldTab != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//å¾ªç¯åŸtableæ•°ç»„ ï¼Ÿå› ä¸ºåœ¨æ‰©å®¹å hash &amp; (size-1) çš„ä½ç½®å‘ç”Ÿäº†å˜åŒ– ï¼Œæ‰€ä»¥åº”å½“è¿›è¡Œé‡æ’</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oldCap; ++j) &#123; </span><br><span class="line">                Node&lt;K,V&gt; e;</span><br><span class="line">                <span class="keyword">if</span> ((e = oldTab[j]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    oldTab[j] = <span class="keyword">null</span>;</span><br><span class="line">                    <span class="keyword">if</span> (e.next == <span class="keyword">null</span>)<span class="comment">//è¯´æ˜eä¸å­˜åœ¨hashå†²çª</span></span><br><span class="line">                        newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                        ((TreeNode&lt;K,V&gt;)e).split(<span class="keyword">this</span>, newTab, j, oldCap);</span><br><span class="line">                    <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                        Node&lt;K,V&gt; loHead = <span class="keyword">null</span>, loTail = <span class="keyword">null</span>;</span><br><span class="line">                        Node&lt;K,V&gt; hiHead = <span class="keyword">null</span>, hiTail = <span class="keyword">null</span>;</span><br><span class="line">                        Node&lt;K,V&gt; next;</span><br><span class="line">                        <span class="keyword">do</span> &#123; <span class="comment">//å†å»å¾ªç¯bin</span></span><br><span class="line">                            next = e.next;</span><br><span class="line">                            <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123; <span class="comment">//å¦‚æœåœ¨ä½ä½ ï¼ˆè€ï¼‰æ•°ç»„ä¸­ä¹Ÿå°±æ˜¯å…ƒç´ hastå’Œå°±æ•°ç»„å–æ¨¡ä¸º0æ—¶ï¼Œè¯´æ˜é‡æ’åä»åœ¨è€æ•°ç»„å†…</span></span><br><span class="line">                                <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">                                    loHead = e;</span><br><span class="line">                                <span class="keyword">else</span></span><br><span class="line">                                    loTail.next = e;</span><br><span class="line">                                loTail = e;<span class="comment">//é€’å½’å‘ä¸‹ç»§ç»­æ’</span></span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> &#123;<span class="comment">//å¦åˆ™åœ¨é«˜ä½æ•°ç»„ä¸­ ï¼Œä¹Ÿå°±æ˜¯åœ¨æ‰©å®¹å‡ºæ¥çš„æ•°ç»„ä¸­</span></span><br><span class="line">                                <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">                                    hiHead = e;</span><br><span class="line">                                <span class="keyword">else</span></span><br><span class="line">                                    hiTail.next = e;</span><br><span class="line">                                hiTail = e;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line">                        <span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            loTail.next = <span class="keyword">null</span>;</span><br><span class="line">                            newTab[j] = loHead; <span class="comment">//ä½ä½æ•°ç»„è¿˜æ˜¯åœ¨åŸæ¥çš„ä½ç½®ä¸Š</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">                            newTab[j + oldCap] = hiHead; <span class="comment">//é«˜ä½æ•°ç»„åœ¨æ—§æ•°ç»„+jçš„ä½ç½®ä¸Š</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> newTab;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="getæ–¹æ³•"><a href="#getæ–¹æ³•" class="headerlink" title="getæ–¹æ³•"></a>getæ–¹æ³•</h3><p>getæ–¹æ³•æ˜¯æ ¹æ®hashå’Œkeyå€¼è¿›è¡ŒæŸ¥æ‰¾,åŒç†containKeyæ–¹æ³•ä¹Ÿæ˜¯è°ƒç”¨getNodeæ–¹æ³•è¿›è¡Œåˆ¤æ–­ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class="keyword">int</span> n; K k;</span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// å…ˆå›æ£€æŸ¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">              <span class="comment">/* ä»ç¬¬äºŒä¸ªèŠ‚ç‚¹å¼€å§‹å¾ªç¯ æŸ¥æ‰¾hashå’Œkeyåˆ†åˆ«ç›¸åŒ  */</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="removeæ–¹æ³•"><a href="#removeæ–¹æ³•" class="headerlink" title="removeæ–¹æ³•"></a>removeæ–¹æ³•</h3><p>ä½¿ç”¨removeæ–¹æ³•æ ¹æ®keyç§»é™¤èŠ‚ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">remove</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = removeNode(hash(key), key, <span class="keyword">null</span>, <span class="keyword">false</span>, <span class="keyword">true</span>)) == <span class="keyword">null</span> ?</span><br><span class="line">        <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements Map.remove and related methods</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hash keyçš„hashå€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> key é”®å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> value å¦‚æœæƒ³åŒ¹é…çš„è¯å°±æ˜¯valueï¼Œå¦åˆ™ç©º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> matchValue å¦‚æœæ˜¯tureé‚£ä¹ˆå°±ç§»é™¤å’Œvalue equalçš„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> movable å¦‚æœæ˜¯falseçš„è¯ï¼Œç§»é™¤è¿™ä¸ªèŠ‚ç‚¹ä¸è¦ç§»åŠ¨å…¶ä»–èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the node, or null if none</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">removeNode</span><span class="params">(<span class="keyword">int</span> hash, Object key, Object value,</span></span></span><br><span class="line"><span class="function"><span class="params">                           <span class="keyword">boolean</span> matchValue, <span class="keyword">boolean</span> movable)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, index;</span><br><span class="line">    <span class="comment">/* ç¡®å®šèŠ‚ç‚¹ */</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (p = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        Node&lt;K,V&gt; node = <span class="keyword">null</span>, e; K k; V v;</span><br><span class="line">        <span class="comment">/* å¦‚æœhashå€¼ç›¸åŒ keyå€¼ä¹Ÿç›¸åŒ è¯´æ˜å°±æ˜¯è¿™ä¸ªèŠ‚ç‚¹ */</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">            ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            node = p;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((e = p.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">          <span class="comment">/* å¦åˆ™æ¨ªå‘æŸ¥æ‰¾ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ */</span></span><br><span class="line">            <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="comment">/* çœç•¥-------- */</span></span><br><span class="line">                &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (node != <span class="keyword">null</span> &amp;&amp; (!matchValue || (v = node.value) == value ||</span><br><span class="line">                             (value != <span class="keyword">null</span> &amp;&amp; value.equals(v)))) &#123;</span><br><span class="line">            <span class="keyword">if</span> (node <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                ((TreeNode&lt;K,V&gt;)node).removeTreeNode(<span class="keyword">this</span>, tab, movable);</span><br><span class="line">                <span class="comment">/* æ¥ä¸‹æ¥æŠŠtabä¸­å¯¹åº”çš„index removeæ‰ */</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (node == p)</span><br><span class="line">                tab[index] = node.next;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                p.next = node.next;</span><br><span class="line">            ++modCount;</span><br><span class="line">            --size;</span><br><span class="line">            afterNodeRemoval(node);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="keySetæ–¹æ³•"><a href="#keySetæ–¹æ³•" class="headerlink" title="keySetæ–¹æ³•"></a>keySetæ–¹æ³•</h3><p>ketSetæ–¹æ³•ä¹Ÿæ˜¯ç»å¸¸ç”¨åˆ°çš„æ–¹æ³•ï¼ŒkeySetæ–¹æ³•å®é™…ä¸Šå°±æ˜¯è¿”å›æ–°å»ºçš„keysetç»“æ„ã€‚å…·ä½“ç»“æ„å¯ä»¥çœ‹å¦‚ä¸‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°åªæœ‰ä½¿ç”¨forEachå’ŒIteratoræ–¹æ³•çš„æ—¶å€™æ‰ä¼šå¾ªç¯tabæ¥æ‰¾keyçš„setæ•°æ®ã€‚æ•°æ®ç»“æ„ä¸­éƒ½æ˜¯è°ƒç”¨å¤–éƒ¨æ–¹æ³•çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">KeySet</span> <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">K</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span>                 </span>&#123; <span class="keyword">return</span> size; &#125; <span class="comment">//è¿”å›å½“å‰size</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span>               </span>&#123; HashMap.<span class="keyword">this</span>.clear(); &#125; <span class="comment">//ç›´æ¥è°ƒç”¨hashMapçš„clearæ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Iterator&lt;K&gt; <span class="title">iterator</span><span class="params">()</span>     </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> KeyIterator(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123; <span class="keyword">return</span> containsKey(o); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> removeNode(hash(key), key, <span class="keyword">null</span>, <span class="keyword">false</span>, <span class="keyword">true</span>) != <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Spliterator&lt;K&gt; <span class="title">spliterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> KeySpliterator&lt;&gt;(HashMap.<span class="keyword">this</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">forEach</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> K&gt; action)</span> </span>&#123;</span><br><span class="line">        Node&lt;K,V&gt;[] tab;</span><br><span class="line">        <span class="keyword">if</span> (action == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        <span class="keyword">if</span> (size &gt; <span class="number">0</span> &amp;&amp; (tab = table) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> mc = modCount;</span><br><span class="line">            <span class="comment">/* æŠŠå½“å‰æ“ä½œæ•°è®°ä¸‹æ¥  */</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tab.length; ++i) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Node&lt;K,V&gt; e = tab[i]; e != <span class="keyword">null</span>; e = e.next)</span><br><span class="line">                    action.accept(e.key);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (modCount != mc)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯å‡ ä¸ªéå¸¸å¸¸ç”¨çš„hashMapçš„æ–¹æ³•å’ŒåŸºæœ¬çš„æ•°æ®ç»“æ„æºç çš„åˆ†ææŸ¥çœ‹ã€‚å°±å½“åšç¬”è®°è®°å½•ä¸€ä¸‹ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-10-08T15:00:00.000Z" title="2018-10-08T15:00:00.000Z">2018-10-08</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">11 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1675 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/08/2018-10-08-LinkedList%E7%9A%84%E6%BA%90%E7%A0%81%E6%9F%A5%E7%9C%8B/">LinkedListçš„æºç æŸ¥çœ‹</a></h1><div class="content"><h1 id="LinkedListçš„æºç æŸ¥çœ‹"><a href="#LinkedListçš„æºç æŸ¥çœ‹" class="headerlink" title="LinkedListçš„æºç æŸ¥çœ‹"></a>LinkedListçš„æºç æŸ¥çœ‹</h1><h2 id="ç»“æ„æºç "><a href="#ç»“æ„æºç " class="headerlink" title="ç»“æ„æºç "></a>ç»“æ„æºç </h2><p>LinkedListæ˜¯ä¸€ä¸ª<strong>åŒå‘é“¾è¡¨</strong>ï¼Œå› ä¸ºå®ƒå…·æœ‰nextå’Œprevçš„å‰åå¼•ç”¨ã€‚æ‰€ä»¥æ¯æ¬¡æ·»åŠ å…ƒç´ ï¼Œç§»é™¤å…ƒç´ æ—¶ï¼Œéœ€è¦è€ƒè™‘ä¸¤ä¸ªæŒ‡é’ˆçš„å¼•ç”¨æƒ…å†µï¼Œä¿è¯å¯¹å‰ä¸€ä¸ªå…ƒç´ çš„å®Œå…¨æ–­å¼€å’Œæ–°å…ƒç´ çš„å®Œå…¨å¼•ç”¨ï¼Œå¦‚æœåœ¨æŒ‡å®šä½ç½®ä¸Šè¿æ¥å…ƒç´ çš„è¿‡ç¨‹å’Œç»“æ„å¯ä»¥å‚è€ƒä¸‹å›¾ï¼š</p>
<p><img src="https://raw.githubusercontent.com/NanYinIU/PicRoom/master/img/20191219112513.png" alt="LinkedListç»“æ„å‚è€ƒ"></p>
<h3 id="ä¾èµ–ç»“æ„"><a href="#ä¾èµ–ç»“æ„" class="headerlink" title="ä¾èµ–ç»“æ„"></a>ä¾èµ–ç»“æ„</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* LinkedListçš„å†…éƒ¨å˜é‡ å¯ä»¥çœ‹å‡ºLinkedListå…¶å®å°±æ˜¯ä¸€ä¸ªé“¾è¡¨ */</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŒ‡å‘é¦–èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * Invariant: (first == null &amp;&amp; last == null) ||</span></span><br><span class="line"><span class="comment"> *            (first.prev == null &amp;&amp; first.item != null)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;E&gt; first;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŒ‡å‘å°¾èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * Invariant: (first == null &amp;&amp; last == null) ||</span></span><br><span class="line"><span class="comment"> *            (last.next == null &amp;&amp; last.item != null)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;E&gt; last;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å†…éƒ¨nodeå®ç° */</span></span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"><span class="comment">/* åŒå‘é“¾è¡¨ */</span></span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.item = element;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">        <span class="keyword">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="LinkedListæ„é€ å‡½æ•°"><a href="#LinkedListæ„é€ å‡½æ•°" class="headerlink" title="LinkedListæ„é€ å‡½æ•°"></a>LinkedListæ„é€ å‡½æ•°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ç©ºæ„é€ å‡½æ•° æ¯”è¾ƒå¸¸ç”¨ */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æœ‰collectionå‚æ•°çš„æ„é€ å‡½æ•° */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>();</span><br><span class="line">    addAll(c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> addAll(size, c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å‚æ•°ï¼šå½“å‰æ•°é‡ä¹Ÿå°±æ˜¯è¦å¾—åˆ°å½“å‰é“¾è¡¨çš„ä½ç½® */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    checkPositionIndex(index);</span><br><span class="line"></span><br><span class="line">    Object[] a = c.toArray();</span><br><span class="line">    <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">    <span class="keyword">if</span> (numNew == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    Node&lt;E&gt; pred, succ;</span><br><span class="line">    <span class="comment">// å¯¹æ’å…¥å‰æƒ…å†µçš„åˆ¤æ–­</span></span><br><span class="line">    <span class="keyword">if</span> (index == size) &#123;</span><br><span class="line"><span class="comment">//          å¦‚æœåœ¨å°¾éƒ¨æ’å…¥ pred=æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        succ = <span class="keyword">null</span>;</span><br><span class="line">        pred = last;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//          å¦åˆ™åœ¨ä¸­éƒ¨æ’å…¥ succ=å½“å‰èŠ‚ç‚¹ pred=å‰ä¸€èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">/* - - - - - - - - -  */</span></span><br><span class="line"><span class="comment">/*     ^ ^ */</span></span><br><span class="line"><span class="comment">/*     1 2  å¦‚æœæƒ³åœ¨2ä½ç½®æ’å…¥å…ƒç´ ï¼Œå‰ä¸€ä¸ªå…ƒç´ ä¸åŠ¨ï¼Œå°†åé¢çš„å…ƒç´ åç§»*/</span></span><br><span class="line">        succ = node(index);</span><br><span class="line">        pred = succ.prev;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (Object o : a) &#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>) E e = (E) o;</span><br><span class="line"><span class="comment">// æ„é€ æ–¹æ³• å‰èŠ‚ç‚¹/å†…å®¹/åèŠ‚ç‚¹ å§‹ç»ˆpredæ˜¯å‰ç½®èŠ‚ç‚¹</span></span><br><span class="line">        Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(pred, e, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">if</span> (pred == <span class="keyword">null</span>)</span><br><span class="line"><span class="comment">// å¦‚æœpred==null è¯´æ˜ æœ¬èº«åˆ—è¡¨å¼€å§‹å°±æ˜¯ç©ºçš„æˆ–è€…åœ¨å¼€å¤´æ’å…¥å…ƒç´ </span></span><br><span class="line">            first = newNode;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line"><span class="comment">// å¦åˆ™åœ¨åé¢æ’å…¥newNode</span></span><br><span class="line">            pred.next = newNode;</span><br><span class="line"><span class="comment">// å‘åå¾ªç¯èŠ‚ç‚¹</span></span><br><span class="line">        pred = newNode;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// å¦‚æœsucc==null è¯´æ˜åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹åä½ç½® </span></span><br><span class="line"><span class="comment">// å°†æœ€åçš„æ–°æ’å…¥çš„å…ƒç´ predèµ‹å€¼ç»™last</span></span><br><span class="line">    <span class="keyword">if</span> (succ == <span class="keyword">null</span>) &#123;</span><br><span class="line">        last = pred;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">/* å¦åˆ™æ’å…¥åœ¨succå‰ */</span></span><br><span class="line">        pred.next = succ;</span><br><span class="line">        succ.prev = pred;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    size += numNew;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åŸºæœ¬æ–¹æ³•"><a href="#åŸºæœ¬æ–¹æ³•" class="headerlink" title="åŸºæœ¬æ–¹æ³•"></a>åŸºæœ¬æ–¹æ³•</h2><h3 id="æ·»åŠ "><a href="#æ·»åŠ " class="headerlink" title="æ·»åŠ "></a>æ·»åŠ </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* addæ–¹æ³•é»˜è®¤è°ƒç”¨linklastæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å‘åæ·»åŠ å…ƒç´  */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    linkLast(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŒæ ·æœ‰addLast è¾¾åˆ°ç›¸åŒçš„ç›®çš„ï¼Œå°±æ˜¯ä¸è¿”å›ä»»ä½•ä¸œè¥¿ */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        linkLast(e);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨addæ–¹æ³•åä¼šé»˜è®¤çš„è°ƒç”¨ linkLast åå°†å…ƒç´ æ·»åŠ è‡³Listçš„æœ«å°¾ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linkLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="comment">/* è·å¾—æœ€åä¸€ä¸ªå…ƒç´ å½“ä½œæ–°èŠ‚ç‚¹çš„å‰ç½®èŠ‚ç‚¹ */</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(l, e, <span class="keyword">null</span>);</span><br><span class="line">    <span class="comment">/* æŠŠå½“å‰èŠ‚ç‚¹ä»˜ç»™last */</span></span><br><span class="line">    last = newNode;</span><br><span class="line">    <span class="keyword">if</span> (l == <span class="keyword">null</span>)</span><br><span class="line">        first = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="comment">// å°†lastçš„nextæŒ‡å‘æ–°èŠ‚ç‚¹,å®ŒæˆåŒæ–¹ç›¸äº’é“¾æ¥</span></span><br><span class="line">        l.next = newNode;</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ä¹Ÿå¯ä»¥è°ƒç”¨æ–¹æ³•åœ¨æœ€å‰é¢æ·»åŠ å…ƒç´ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    linkFirst(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">linkFirst</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–é¦–èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="comment">// è®¾ç½®æ–°èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(<span class="keyword">null</span>, e, f);</span><br><span class="line">    <span class="comment">//è®¾ç½®æ–°èŠ‚ç‚¹ä¸ºé¦–èŠ‚ç‚¹</span></span><br><span class="line">    first = newNode;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="keyword">null</span>)</span><br><span class="line">        last = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="comment">// å°†æ–°èŠ‚ç‚¹ä¸åŸé¦–èŠ‚ç‚¹è¿æ¥</span></span><br><span class="line">        f.prev = newNode;</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç§»é™¤"><a href="#ç§»é™¤" class="headerlink" title="ç§»é™¤"></a>ç§»é™¤</h3><h4 id="removeæ–¹æ³•"><a href="#removeæ–¹æ³•" class="headerlink" title="removeæ–¹æ³•"></a>removeæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* å…ˆåˆ¤æ–­æ˜¯å¦è¶Šç•Œ */</span></span><br><span class="line">      checkElementIndex(index);</span><br><span class="line">      <span class="keyword">return</span> unlink(node(index));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="function">E <span class="title">unlink</span><span class="params">(Node&lt;E&gt; x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert x != null;</span></span><br><span class="line">    <span class="keyword">final</span> E element = x.item;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = x.next;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; prev = x.prev;</span><br><span class="line"><span class="comment">/* å¦‚æœprevæ˜¯ç©º è¯´æ˜å½“å‰å…ƒç´ æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´  å¦‚ A B C ç§»é™¤Aï¼Œç›´æ¥å°†BæŒ‡å‘é¦–èŠ‚ç‚¹å³å¯ */</span></span><br><span class="line">    <span class="keyword">if</span> (prev == <span class="keyword">null</span>) &#123;</span><br><span class="line">        first = next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">/* å½“å‰èŠ‚ç‚¹ä¸å‰åèŠ‚ç‚¹æ–­ç»é“¾æ¥ å¦‚ABCç§»é™¤Bï¼Œåˆ™éœ€è¦å°†A.nextæŒ‡å‘Cï¼ŒB.preæŒ‡å‘ç©º */</span></span><br><span class="line">        prev.next = next;</span><br><span class="line">        x.prev = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å› ä¸ºLinkedListä¸ºåŒå‘é“¾è¡¨ï¼Œéœ€è¦å–æ¶ˆnextå’Œprev</span></span><br><span class="line"><span class="comment">/* å¦‚æœæ˜¯æœ€åä¸€ä¸ªå…ƒç´  */</span></span><br><span class="line">    <span class="keyword">if</span> (next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        last = prev;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">/* å½“å‰èŠ‚ç‚¹ä¸å‰åèŠ‚ç‚¹æ–­ç»é“¾æ¥ å› ä¸ºLinkedListæ˜¯åŒå‘é“¾è¡¨ */</span></span><br><span class="line">        next.prev = prev;</span><br><span class="line">        x.next = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/* ç½®ç©º */</span></span><br><span class="line">    x.item = <span class="keyword">null</span>; </span><br><span class="line">    size--;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="removeFirst"><a href="#removeFirst" class="headerlink" title="removeFirst"></a>removeFirst</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">removeFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    <span class="keyword">return</span> unlinkFirst(f);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> E <span class="title">unlinkFirst</span><span class="params">(Node&lt;E&gt; f)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert f == first &amp;&amp; f != null;</span></span><br><span class="line">    <span class="keyword">final</span> E element = f.item;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = f.next;</span><br><span class="line">    f.item = <span class="keyword">null</span>;</span><br><span class="line">    f.next = <span class="keyword">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    first = next;</span><br><span class="line">    <span class="keyword">if</span> (next == <span class="keyword">null</span>)</span><br><span class="line">        last = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        next.prev = <span class="keyword">null</span>;</span><br><span class="line">    size--;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="removeLast-å’ŒremoveFirståŒç†"><a href="#removeLast-å’ŒremoveFirståŒç†" class="headerlink" title="removeLast å’ŒremoveFirståŒç†"></a>removeLast å’ŒremoveFirståŒç†</h4><h3 id="èµ‹å€¼å–å€¼æ“ä½œ"><a href="#èµ‹å€¼å–å€¼æ“ä½œ" class="headerlink" title="èµ‹å€¼å–å€¼æ“ä½œ"></a>èµ‹å€¼å–å€¼æ“ä½œ</h3><h4 id="getæ–¹æ³•"><a href="#getæ–¹æ³•" class="headerlink" title="getæ–¹æ³•"></a>getæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    checkElementIndex(index);</span><br><span class="line">    <span class="comment">/* å¾—åˆ°indexå¤„èŠ‚ç‚¹çš„itemä¿¡æ¯ */</span></span><br><span class="line">    <span class="keyword">return</span> node(index).item;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Node&lt;E&gt; <span class="title">node</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// assert isElementIndex(index);</span></span><br><span class="line">        <span class="comment">// åˆ†ä¸¤ä¸ªæ–¹å‘æŸ¥æ‰¾ï¼Œ1.å¦‚æœç»™å®šçš„indexå°äºsizeçš„ä¸€åŠ</span></span><br><span class="line">    <span class="keyword">if</span> (index &lt; (size &gt;&gt; <span class="number">1</span>)) &#123;</span><br><span class="line">        Node&lt;E&gt; x = first;</span><br><span class="line">        <span class="comment">//ä»å¤´å¼€å§‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; index; i++)</span><br><span class="line">            x = x.next;</span><br><span class="line">            <span class="comment">// è¿”å›æœ€åä¸€ä¸ª</span></span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 2.å¦‚æœç»™å®šçš„indexå¤§äºsizeçš„ä¸€åŠ</span></span><br><span class="line">        Node&lt;E&gt; x = last;</span><br><span class="line">        <span class="comment">// ä»å°¾éƒ¨å¼€å§‹æ‰¾</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = size - <span class="number">1</span>; i &gt; index; i--)</span><br><span class="line">            x = x.prev;</span><br><span class="line">            <span class="comment">//è¿”å›æœ€åçš„é‚£ä¸ª</span></span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="setæ–¹æ³•"><a href="#setæ–¹æ³•" class="headerlink" title="setæ–¹æ³•"></a>setæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    checkElementIndex(index);</span><br><span class="line">    Node&lt;E&gt; x = node(index);</span><br><span class="line">    E oldVal = x.item;</span><br><span class="line">    x.item = element;</span><br><span class="line">    <span class="comment">/* setæ–¹æ³•ä¼šè¿”å›åŸæ¥çš„å€¼ */</span></span><br><span class="line">    <span class="keyword">return</span> oldVal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="LinkedListä¸­çš„æ ˆæ“ä½œ"><a href="#LinkedListä¸­çš„æ ˆæ“ä½œ" class="headerlink" title="LinkedListä¸­çš„æ ˆæ“ä½œ"></a>LinkedListä¸­çš„æ ˆæ“ä½œ</h3><h4 id="peekæ–¹æ³•"><a href="#peekæ–¹æ³•" class="headerlink" title="peekæ–¹æ³•"></a>peekæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Retrieves, but does not remove, the head (first element) of this list.</span></span><br><span class="line"><span class="comment"> * åªæ˜¯æ£€ç´¢æ ˆé¦–å…ƒç´ ï¼Œä½†å¹¶ä¸å¼¹å‡º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the head of this list, or &#123;<span class="doctag">@code</span> null&#125; if this list is empty</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : f.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒç† <code>peekFirst</code> å’Œ <code>peekLast</code></p>
<h4 id="pollæ–¹æ³•"><a href="#pollæ–¹æ³•" class="headerlink" title="pollæ–¹æ³•"></a>pollæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Retrieves and removes the head (first element) of this list.</span></span><br><span class="line"><span class="comment"> * æ£€ç´¢å¹¶ä¸”ç§»é™¤æ ˆé¦–å…ƒç´  unlinkFirstæ˜¯å¯ä»¥è¿”å›ç§»é™¤å…ƒç´ çš„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the head of this list, or &#123;<span class="doctag">@code</span> null&#125; if this list is empty</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">poll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : unlinkFirst(f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒç†  <code>pollFirst</code> å’Œ <code>pollLast</code></p>
<h4 id="pushæ–¹æ³•"><a href="#pushæ–¹æ³•" class="headerlink" title="pushæ–¹æ³•"></a>pushæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Pushes an element onto the stack represented by this list.  In other</span></span><br><span class="line"><span class="comment"> * words, inserts the element at the front of this list.</span></span><br><span class="line"><span class="comment"> * åœ¨æ ˆé¦–å †ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment"> * &lt;p&gt;This method is equivalent to &#123;<span class="doctag">@link</span> #addFirst&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> e the element to push</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    addFirst(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="popæ–¹æ³•"><a href="#popæ–¹æ³•" class="headerlink" title="popæ–¹æ³•"></a>popæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Pops an element from the stack represented by this list.  In other</span></span><br><span class="line"><span class="comment"> * words, removes and returns the first element of this list.</span></span><br><span class="line"><span class="comment"> * å‡ºæ ˆ</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;This method is equivalent to &#123;<span class="doctag">@link</span> #removeFirst()&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the element at the front of this list (which is the top</span></span><br><span class="line"><span class="comment"> *         of the stack represented by this list)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> NoSuchElementException if this list is empty</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> removeFirst();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="offeræ–¹æ³•"><a href="#offeræ–¹æ³•" class="headerlink" title="offeræ–¹æ³•"></a>offeræ–¹æ³•</h4><p>å®é™…ä¸Š <code>offer</code> æ˜¯è°ƒç”¨çš„ <code>add</code> æ–¹æ³•ï¼Œä½†æ˜¯åŒºåˆ«å°±åœ¨ <code>linkedlist</code> ç»§æ‰¿äº† <code>Dequ</code> å’Œ <code>List</code> çˆ¶ç±»ã€‚ä¸€èˆ¬å½“ <code>queue</code> ç”¨çš„æ—¶å€™è¦ç”¨ <code>offer/push/pop</code>  è€Œå½“ä½¿ç”¨ <code>list</code> çš„æ—¶å€™ç”¨ <code>add/remove</code> ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡æŸ¥çœ‹LinkedListçš„æºç å¯ä»¥å‘ç°ï¼š</p>
<ol>
<li>é¦–å…ˆå¯ä»¥ç¡®å®šLinkedLIstæ˜¯ä¸€ä¸ªé€šè¿‡Nodeç»“æ„å®ç°çš„åŒå‘é“¾è¡¨</li>
<li>å…¶æ¬¡é€šè¿‡addå’Œremoveæ–¹æ³•å¯ä»¥çœ‹å‡ºå®ƒä¸å‘ArrayListä¸€æ ·ï¼Œéœ€è¦å¯¹å®¹é‡è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œè€Œæ˜¯é€šè¿‡â€˜æŒ‡é’ˆâ€™æŒ‡å‘å‰åèŠ‚ç‚¹å®ç°çš„â€˜è¿æ¥â€™ã€‚</li>
<li>ç„¶åé€šè¿‡getæ–¹æ³•å¯ä»¥çœ‹å‡ºæŸ¥æ‰¾ä¸€ä¸ªç‰¹å®šä½ç½®ä¸Šçš„éå¸¸éº»çƒ¦ï¼Œéœ€è¦éå†Listï¼Œå°½ç®¡ä½¿ç”¨äº†äºŒåˆ†çš„æ–¹å¼è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½†æ˜¯æŸ¥æ‰¾æ€§èƒ½ä¾æ—§ä¸èƒ½å’ŒArrayListç›¸æ¯”ã€‚</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-10-04T15:00:00.000Z" title="2018-10-04T15:00:00.000Z">2018-10-04</time><span class="level-item"> NanYin </span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">9 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1321 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/04/2018-10-04-ArrayList%E7%9A%84%E6%BA%90%E7%A0%81%E6%9F%A5%E7%9C%8B/">ArrayListçš„æºç æŸ¥çœ‹</a></h1><div class="content"><h1 id="ArrayListçš„æºç "><a href="#ArrayListçš„æºç " class="headerlink" title="ArrayListçš„æºç "></a>ArrayListçš„æºç </h1><table>
<thead>
<tr>
<th>å˜é‡</th>
<th>å«ä¹‰</th>
<th>é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody><tr>
<td>DEFAULT_CAPACITY</td>
<td>é»˜è®¤çš„Liståˆå§‹åŒ–å®¹é‡</td>
<td>10</td>
</tr>
<tr>
<td>EMPTY_ELEMENTDATA</td>
<td>ç©ºå®ä¾‹çš„ç©ºæ•°ç»„å†…å®¹</td>
<td>{}</td>
</tr>
<tr>
<td>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</td>
<td>å…±äº«çš„ç©ºæ•°ç»„å®ä¾‹ï¼Œç”¨äºé»˜è®¤å¤§å°çš„ç©ºå®ä¾‹ã€‚</td>
<td>{}</td>
</tr>
<tr>
<td>elementData</td>
<td>å­˜å‚¨ArrayListå†…å®¹çš„æ•°ç»„ç¼“å†²åŒº,é»˜è®¤æ—¶ elementData == DEL</td>
<td>[]</td>
</tr>
<tr>
<td>size</td>
<td>elementDataæ•°ç»„å¤§å°</td>
<td></td>
</tr>
</tbody></table>
<p>å…¶ä¸­ <strong>elementDataæ•°ç»„æ˜¯ArrayListçš„å­˜å‚¨ç»“æ„,ä¹Ÿå°±æ˜¯è¯´ArrayListä½¿ç”¨æ•°ç»„å­˜å‚¨å…ƒç´ </strong>, ä½†åŒæ—¶æ˜¯ä½¿ç”¨transientè¿›è¡Œä¿®é¥°çš„,ä¹Ÿå°±æ˜¯ä¸èƒ½åºåˆ—åŒ–çš„,ä½†å®é™…ä¸ŠArrayListå®ç°äº†Serializableæ¥å£,é‚£ä¹ˆè¿™ä¹ˆåšçš„åŸå› æ—¶ä»€ä¹ˆ?</p>
<p>å› ä¸ºArrayListå…·æœ‰è‡ªåŠ¨æ‰©å®¹æœºåˆ¶,å…ƒç´ åˆ°ä¸€å®šçš„å¤§å°å°±ä¼šè‡ªåŠ¨æ‰©å®¹,è¿™å°±ä¼šå¯¼è‡´ArrayListä¸­çš„å…ƒç´ ä¸€å®šä¸æ˜¯æ»¡çš„,ä¹Ÿå°±æ˜¯è¯´å¦‚æœå½“å‰ArrayListçš„å¤§å°æ—¶50,å®é™…å…ƒç´ å¯èƒ½è¿œè¿œå°äº50,æ­¤æ—¶å°±æ²¡æœ‰å°†å…¨éƒ¨elementDataéƒ½åºåˆ—åŒ–çš„å¿…è¦äº†.</p>
<p>æ‰€ä»¥,ArrayListæä¾›äº†ä¸€ä¸ªwriteObjectæ–¹æ³•,ä¸“é—¨å¯¹elementDataè¿›è¡Œåºåˆ—åŒ–.é‡Œé¢ä½¿ç”¨å¯¹å°äºsizeçš„æ‰€æœ‰å…ƒç´ è¿›è¡Œåºåˆ—åŒ–,å°±é¿å…äº†ä¸Šé¢é˜è¿°çš„é—®é¢˜.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++) &#123;</span><br><span class="line">    s.writeObject(elementData[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ„é€ å‡½æ•°æºç "><a href="#æ„é€ å‡½æ•°æºç " class="headerlink" title="æ„é€ å‡½æ•°æºç "></a>æ„é€ å‡½æ•°æºç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ²¡æœ‰å‚æ•°çš„æƒ…å†µä¸‹ */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®é»˜è®¤çš„å†…å®¹ä¸º&#123;&#125;</span></span><br><span class="line">    <span class="keyword">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* é»˜è®¤æ˜¯æ‹¥æœ‰é»˜è®¤å®¹é‡ï¼ˆ10ï¼‰çš„ç©ºçš„ array list */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"><span class="comment">/* è¿™ä¸ªé»˜è®¤çš„å®¹é‡æ˜¯å®šä¹‰å¥½çš„10  */</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å½“å‚æ•°æ˜¯å®¹é‡çš„å¤§å°çš„æ—¶å€™  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">/* å¦‚æœè‡ªå®šä¹‰åˆå§‹å®¹é‡å¤§å°*/</span></span><br><span class="line">        <span class="keyword">this</span>.elementData = <span class="keyword">new</span> Object[initialCapacity];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">/* å¦‚æœå‚æ•°å°äº0 æŠ¥å‚æ•°å¼‚å¸¸çš„é”™è¯¯ï¼ˆIllegalArgumentExceptionï¼‰ */</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Capacity: "</span>+</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å½“å‚æ•°æ˜¯ä¸€ä¸ªCollectionç»“æ„çš„æ—¶å€™ */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">     elementData = c.toArray();</span><br><span class="line">     <span class="keyword">if</span> ((size = elementData.length) != <span class="number">0</span>) &#123;</span><br><span class="line">         <span class="comment">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span></span><br><span class="line">         <span class="keyword">if</span> (elementData.getClass() != Object[].class)</span><br><span class="line">         <span class="comment">/* å¦‚æœä¸æ˜¯objectç±»å‹çš„è¯ è½¬æ¢æˆobjectç±»å‹ */</span></span><br><span class="line">             elementData = Arrays.copyOf(elementData, size, Object[].class);</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="comment">// replace with empty array.</span></span><br><span class="line">         <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸ç”¨æ–¹æ³•æºç "><a href="#å¸¸ç”¨æ–¹æ³•æºç " class="headerlink" title="å¸¸ç”¨æ–¹æ³•æºç "></a>å¸¸ç”¨æ–¹æ³•æºç </h2><p>åœ¨çœ‹æºç ä¹‹å‰å…ˆé€šè¿‡ä¸‹é¢è¿™å¼ å›¾ç‰‡äº†è§£ä»¥ä¸‹å¦‚æœæ–°å»ºä¸€ä¸ªArrayListåæ·»åŠ ä¸€ä¸ªå…ƒç´ çš„å¤§è‡´è¿‡ç¨‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/NanYinIU/PicRoom/master/img/ArrayList%E6%B7%BB%E5%8A%A0%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90.png" alt="è¿‡ç¨‹å›¾"></p>
<ul>
<li>add æ·»åŠ æ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ·»åŠ  */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* æ‰©å……å®¹é‡ */</span></span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    <span class="comment">/* ArrayListå…¶å®å°±æ˜¯ä¸ªæ•°ç»„ å°†æ–°addçš„å€¼æ”¾åˆ°æ•°ç»„çš„æœ€åé¢ */</span></span><br><span class="line">    elementData[size++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">      ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateCapacity</span><span class="params">(Object[] elementData, <span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* å¦‚æœæ˜¯ç©ºçš„è¯è¿”å› é»˜è®¤æˆ–å½“å‰ */</span></span><br><span class="line">    <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœelementData == &#123;&#125;æ—¶ï¼Œè¿”å›ç»™å‡ºçš„å€¼å’Œé»˜è®¤çš„DEFAULT_CAPACITYå…¶ä¸­å¤§çš„é‚£ä¸ª</span></span><br><span class="line">        <span class="keyword">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">     &#125;</span><br><span class="line">    <span class="keyword">return</span> minCapacity;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* The number of times this list has been &lt;i&gt;structurally modified&lt;/i&gt;. */</span></span><br><span class="line">  <span class="comment">// è¿™ä¸ªmodCount æŒ‡çš„æ˜¯æ•°æ®ç»“æ„æ”¹å˜çš„æ¬¡æ•°ï¼ˆæ¯”å¦‚æ·»åŠ ã€ç§»é™¤å…ƒç´ ï¼‰</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">    <span class="comment">/* å¦‚æœå½“å‰çš„å®¹é‡å¤§äºç»™å®šçš„é•¿åº¦çš„æ—¶å€™ éœ€è¦æ‰©å…… */</span></span><br><span class="line">        grow(minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length; <span class="comment">// åŸé•¿åº¦</span></span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>); <span class="comment">//æ–°é•¿åº¦ å³ç§»è¿ç®—ã€‚é•¿åº¦ä¸º1.5å€çš„åŸé•¿åº¦</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">   <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    <span class="comment">// ä½¿ç”¨Arrays.copyofæ–¹æ³•è¿›è¡Œæœ€ç»ˆæ‰©å®¹ï¼Œæ‰€ä»¥ArrayListæ·»åŠ å…ƒç´ æ—¶æ¯”è¾ƒè€—è´¹æ€§èƒ½ã€‚</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>remove ç§»é™¤å…ƒç´ æ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å¦‚æœè¶…å‡º åˆ™æŠ›å‡ºIndexOutOfBoundsExceptionå¼‚å¸¸</span></span><br><span class="line">    rangeCheck(index);</span><br><span class="line"></span><br><span class="line">    modCount++;</span><br><span class="line">    E oldValue = elementData(index);</span><br><span class="line">    <span class="comment">/* æƒ³è¦ç§»é™¤å…ƒç´ åé¢å…ƒç´ çš„ä¸ªæ•°*/</span></span><br><span class="line">    <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">    <span class="comment">/* arraycopyæ˜¯ä¸ªnativeæ–¹æ³• ç›¸å½“äºæŠŠindex+1ä½ç½®ä¸Šçš„å…ƒç´ æŒªåˆ°indexä½ç½®ä¸Š */</span></span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                         numMoved);</span><br><span class="line">    elementData[--size] = <span class="keyword">null</span>; <span class="comment">//æ¸…ç©ºå…ƒç´ ï¼Œåˆ©äºGC </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åªä¼šç§»é™¤ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ¡ç›® */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">              <span class="keyword">if</span> (elementData[index] == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">/* è¿™ä¸ªfastRemoveæ–¹æ³•å’Œä¸Šé¢çš„æ–¹æ³•å¤§ç›¸å¾„åº­  */</span></span><br><span class="line">                  fastRemove(index);</span><br><span class="line">                  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">              &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">              <span class="keyword">if</span> (o.equals(elementData[index])) &#123;</span><br><span class="line">                  fastRemove(index);</span><br><span class="line">                  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">              &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>contain æ˜¯å¦åŒ…å«</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> indexOf(o) &gt;= <span class="number">0</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">               <span class="keyword">if</span> (elementData[i]==<span class="keyword">null</span>)</span><br><span class="line">                   <span class="keyword">return</span> i;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="comment">/* å†…éƒ¨å°±æ˜¯forå¾ªç¯ä¸€ä¸ªä¸€ä¸ªåˆ¤æ–­çš„ */</span></span><br><span class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">               <span class="keyword">if</span> (o.equals(elementData[i]))</span><br><span class="line">                   <span class="keyword">return</span> i;</span><br><span class="line">                         &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>get æ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    rangeCheck(index);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> elementData(index);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æœ¬è´¨å°±æ˜¯è¿”å›æ•°ç»„ä½ç½®çš„å…ƒç´  */</span></span><br><span class="line"><span class="function">E <span class="title">elementData</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> (E) elementData[index];</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>æœ‰åºæ€§,å¯é‡å¤æ€§ â€”&gt; å› ä¸ºå†…éƒ¨ä½¿ç”¨æ•°ç»„å®ç°,æ‰€ä»¥å…ƒç´ èƒ½å¤Ÿä¿è¯æœ‰åºæ€§ä¸”èƒ½å¤Ÿæ·»åŠ é‡å¤çš„å…ƒç´ </li>
<li>è®¿é—®å¿« â€”&gt; ArrayListå®ç°äº† RandomAccess æ¥å£,èƒ½å¤Ÿé€šè¿‡getå®ç°å¿«é€Ÿçš„éšæœºè®¿é—®.å› ä¸ºArrayListå…¶ä¸­å†…éƒ¨å­˜å‚¨æ˜¯ä½¿ç”¨æ•°ç»„å®ç°çš„,å…ƒç´ æ˜¯è¿ç»­çš„,é€šè¿‡ä¸‹æ ‡å°±èƒ½å¤Ÿå¾—åˆ°å¯¹åº”å…ƒç´ ,æ‰€ä»¥æ£€ç´¢ä¼šæ¯”è¾ƒå¿«.</li>
<li>æ’å…¥åˆ é™¤æ…¢ â€”&gt; æ’å…¥å’Œç§»é™¤å…ƒç´ æ—¶ï¼Œåœ¨æ‰©å®¹æ—¶,ä½¿ç”¨çš„æ˜¯copyOfæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å°†åŸæ•°ç»„å…ƒç´ æ‹·è´åˆ°ç›®æ ‡æ•°ç»„çš„æ–¹å¼,æ•ˆç‡ä½ä¸‹.</li>
<li>éçº¿ç¨‹å®‰å…¨ â€”&gt; ArrayListæ˜¯éçº¿ç¨‹å®‰å…¨çš„,Vectoræ˜¯ArrayListçš„çº¿ç¨‹å®‰å…¨ç‰ˆæœ¬.åœ¨å¤šçº¿ç¨‹æ—¶,å¯ä½¿ç”¨Vectorä»£æ›¿ArrayList.</li>
</ol>
<blockquote>
<p>RandomAccess åªæ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£,å…¶ä¸­å¹¶æ²¡æœ‰å®ç°æ–¹æ³•,ä»–çš„ä½œç”¨åªæ˜¯ç”¨æ¥æ ‡è®°è¯¥ç»“æ„æ”¯æŒéšæœºè®¿é—®.ä¹Ÿå°±æ˜¯è¯´å®ç°äº†è¿™ä¸ªæ¥å£çš„é›†åˆæ˜¯æ”¯æŒ å¿«é€Ÿéšæœºè®¿é—® ç­–ç•¥çš„.ä¸¾ä¾‹æ¥è®²å°±æ˜¯ ArrayList çš„è®¿é—®æ˜¯éšæœºè®¿é—®,è€Œ LinkedListçš„è®¿é—®åˆ™æ˜¯é¡ºåºè®¿é—®çš„.<br>éšæœºè®¿é—®åœ¨ä½¿ç”¨foriå¾ªç¯æ—¶è¦æ¯”ä½¿ç”¨è¿­ä»£å™¨è®¿é—®å…ƒç´ æ—¶æ•ˆç‡é«˜.</p>
</blockquote>
</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/tags/%E5%9F%BA%E7%A1%80/page/0/">ä¸Šä¸€é¡µ</a></div><div class="pagination-next"><a href="/tags/%E5%9F%BA%E7%A1%80/page/2/">ä¸‹ä¸€é¡µ</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/tags/%E5%9F%BA%E7%A1%80/">1</a></li><li><a class="pagination-link" href="/tags/%E5%9F%BA%E7%A1%80/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="/img/avatar.jpeg" alt="NanYin"></figure><p class="title is-size-4 is-block line-height-inherit">NanYin</p><p class="is-size-6 is-block">not now</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Beijing,China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">102</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">13</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">16</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/nanyiniu" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/nanyiniu"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Bash/"><span class="level-start"><span class="level-item">Bash</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Hibernate/"><span class="level-start"><span class="level-item">Hibernate</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Java/JVM/"><span class="level-start"><span class="level-item">JVM</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="level-start"><span class="level-item">å¤šçº¿ç¨‹</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/MYSQL/"><span class="level-start"><span class="level-item">MYSQL</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Markdown/"><span class="level-start"><span class="level-item">Markdown</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Spring/"><span class="level-start"><span class="level-item">Spring</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/SpringBoot/"><span class="level-start"><span class="level-item">SpringBoot</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="level-start"><span class="level-item">å¤šçº¿ç¨‹</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">å·¥å…·</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="level-start"><span class="level-item">è®¾è®¡æ¨¡å¼</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-16T00:00:00.000Z">2020-04-16</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/16/Java%E7%9A%84%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%92%8C%E6%B5%85%E6%8B%B7%E8%B4%9D/">Javaçš„æ·±æ‹·è´å’Œæµ…æ‹·è´</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Java/">Java</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-05T00:00:00.000Z">2020-04-05</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/05/Jav%20IO%E6%B5%85%E6%9E%90/">Java IOæµ…æ</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Java/">Java</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-29T00:00:00.000Z">2020-03-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/03/29/%E7%BA%BF%E7%A8%8B%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/">çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Java/">Java</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-28T12:00:00.000Z">2020-03-28</time></p><p class="title is-6"><a class="link-muted" href="/2020/03/28/%E4%BD%8D%E8%BF%90%E7%AE%97/">Javaä¸­çš„ä½è¿ç®—</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Java/">Java</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-23T19:45:00.000Z">2020-03-23</time></p><p class="title is-6"><a class="link-muted" href="/2020/03/24/Lambda%20expression/">lambdaè¡¨è¾¾å¼å­¦ä¹ å’Œåº”ç”¨</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Java/">Java</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">å½’æ¡£</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">å››æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">ä¸‰æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">ä¸€æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">åäºŒæœˆ 2019</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">å…«æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">ä¸ƒæœˆ 2019</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">å…­æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">å››æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/01/"><span class="level-start"><span class="level-item">ä¸€æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">åäºŒæœˆ 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/11/"><span class="level-start"><span class="level-item">åä¸€æœˆ 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/10/"><span class="level-start"><span class="level-item">åæœˆ 2018</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/07/"><span class="level-start"><span class="level-item">ä¸ƒæœˆ 2018</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/06/"><span class="level-start"><span class="level-item">å…­æœˆ 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">å››æœˆ 2018</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">ä¸€æœˆ 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">æ ‡ç­¾</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/JVM/"><span class="tag">JVM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag is-grey-lightest">69</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">23</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MYSQL/"><span class="tag">MYSQL</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spring/"><span class="tag">Spring</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SpringBoot/"><span class="tag">SpringBoot</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Thread/"><span class="tag">Thread</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UML/"><span class="tag">UML</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bash/"><span class="tag">bash</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/idea/"><span class="tag">idea</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/markdown/"><span class="tag">markdown</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9F%BA%E7%A1%80/"><span class="tag">åŸºç¡€</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B7%A5%E5%85%B7/"><span class="tag">å·¥å…·</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"><span class="tag">æ­£åˆ™è¡¨è¾¾å¼</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">è®¾è®¡æ¨¡å¼</span><span class="tag is-grey-lightest">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AF%AD%E6%B3%95/"><span class="tag">è¯­æ³•</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">è®¢é˜…æ›´æ–°</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/Fail.png" alt="NanYinçš„åšå®¢" height="28"></a><p class="size-small"><span>&copy; 2020 NanYin</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="My GitHub" href="https://github.com/NanYinIU"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://nanyiniu.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>